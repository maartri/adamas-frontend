<div style="padding:8px">
    <div nz-row>
        <div nz-col nzSpan="24" class="recipient-controls">
            <!--<button class="botton success" (click)="newReferralModal = !newReferralModal"><i nz-icon nzType="plus" nzTheme="outline"></i> New Referral</button> -->
            <button class="botton success" (click)="newReferralModal = !newReferralModal"><i nz-icon nzType="plus" nzTheme="outline"></i> New Referral</button>
            <button class="botton sea" (click)="newOtherModal = true"><i nz-icon nzType="check-circle" nzTheme="outline"></i> New Other</button>
            <button class="botton warn" (click)="newQuoteModal = !newQuoteModal" [disabled]="user == null"><i nz-icon nzType="form" nzTheme="outline"></i> Quote</button>
            <button class="botton other" (click)="saveModal = true" [disabled]="user == null"><i nz-icon nzType="cloud-upload" nzTheme="outline"></i> Save</button>
            <button class="botton extra" (click)="clicky(12)" [disabled]="status?.b_IsDead  || status == null"><i nz-icon nzType="printer" nzTheme="outline"></i> Print</button>

            <!-- <button class="botton other" (click)="openReferModal(null)"><i nz-icon nzType="cloud-upload" nzTheme="outline"></i> Sample</button> -->

            <button class="botton find" (click)="openFindModal()"><i nz-icon nzType="search" nzTheme="outline"></i> Find</button>
        </div>
    </div>
    <div nz-row>
        <div *ngIf="recipientType" nz-col nzSpan="24" style="margin-top:10px;">
            <span class="status active" *ngIf="recipientStatus && recipientStatus == 'active'"><i nz-icon nzType="user" nzTheme="outline"></i> ACTIVE</span>
            <span class="status inactive" *ngIf="recipientStatus && recipientStatus == 'inactive'"><i nz-icon nzType="user" nzTheme="outline"></i> INACTIVE</span>

            <span class="status type"><i nz-icon nzType="user" nzTheme="outline"></i> {{ recipientType }}</span>
            <div class="status-program"><i (click)="programModalOpen = true;loadPrograms()" nz-icon nzType="dollar" nzTheme="outline"></i></div>
        </div>
    </div>
    <div nz-row>
            
        <div nz-col nzSpan="6" style="margin-top: 10px;">
            <app-search-list [view]="0" [(ngModel)]="sample" (ngModelChange)="listChange($event)"></app-search-list>           
        </div>
            
        <div nz-col nzSpan="18">
            <ul class="options">
                <li><button (click)="clicky(0)" [disabled]="status?.b_IsDead || status == null"><div><i class="fas fa-file"></i></div>Refer In</button></li>
                <li><button (click)="clicky(1)" [disabled]="status?.b_IsDead  || status == null"><div><i class="fas fa-file-alt"></i></div>Refer On</button></li>
                <li><button (click)="clicky(2)" [disabled]="status?.b_IsDead || !status?.b_HasReferrals"><div><i class="fas fa-hand-paper"></i></div>Not Proceed</button></li>
                <li><button (click)="clicky(3)" [disabled]="status?.b_IsDead || !status?.b_HasReferrals"><div><i class="fas fa-comment-dots"></i></div>Assess</button></li>
                <li><button (click)="clicky(4)" [disabled]="status?.b_IsDead || !status?.b_HasReferrals"><div><i class="fas fa-file-invoice"></i></div>Admit</button></li>
                <li><button (click)="clicky(5)" [disabled]="status?.b_IsDead || !status?.b_HasActivePrograms"><div><i class="fas fa-hourglass-half"></i></div>Wait List</button></li>
                <li><button (click)="clicky(6)" [disabled]="status?.b_IsDead || !status?.b_HasActivePrograms"><div><i class="fas fa-user-check"></i></div>Discharge</button></li>
                <li><button (click)="clicky(7)" [disabled]="status?.b_IsDead || !status?.b_HasActivePrograms"><div><i class="fas fa-folder-minus"></i></div>Suspend</button></li>
                <li><button (click)="clicky(8)" [disabled]="status?.b_IsDead || (!status?.b_HasOnHoldPrograms && !status?.b_HasOnHoldServices)"><div><i class="fas fa-folder-plus"></i></div>Reinstate</button></li>
                <li><button (click)="clicky(9)" [disabled]="status?.b_IsDead  || status == null"><div><i class="fas fa-procedures"></i></div>Decease</button></li>
                <li><button (click)="clicky(10)" [disabled]="status == null"><div><i class="fas fa-address-book"></i></div>Admin</button></li>
                <li><button (click)="clicky(11)" [disabled]="status?.b_IsDead  || status == null"><div><i class="fas fa-th-list"></i></div>Item</button></li>
                <!-- <li><button (click)="clicky(12)" [disabled]="status?.b_IsDead  || status == null"><div><i class="fas fa-print"></i></div>Print</button></li> -->
            </ul>
        </div>

    
        <!-- <select [(ngModel)]="user" (ngModelChange)="change($event)">
            <option value=""></option>
            <option value="ABBERTON B">ABBERTON B</option>
            <option value="*****AAAZ T">*****AAAZ T</option>
            <option value="3CDC STEPH">3CDC STEPH</option>
        </select> -->
    
        <div nz-col nzSpan="24">
            <nz-tabset *ngIf="user" [nzTabPosition]="'top'" [nzType]="'card'">
                <nz-tab nzTitle="Personal" (nzClick)="view(0)"> </nz-tab>
                <nz-tab nzTitle="Contacts" (nzClick)="view(1)"> </nz-tab>
                <nz-tab nzTitle="Intake Details" (nzClick)="view(2)"></nz-tab>
                <nz-tab nzTitle="Reminders" (nzClick)="view(3)"> </nz-tab>
                <nz-tab nzTitle="OP Notes" (nzClick)="view(4)"> </nz-tab>
                <nz-tab nzTitle="Case Notes" (nzClick)="view(5)"> </nz-tab>
                <nz-tab nzTitle="Incidents" (nzClick)="view(6)"> </nz-tab>
                <nz-tab nzTitle="Permanent Roster" (nzClick)="view(7)"> </nz-tab>
                <nz-tab nzTitle="History" (nzClick)="view(8)"> </nz-tab>
                <nz-tab nzTitle="Insurance & Pension" (nzClick)="view(9)"> </nz-tab>
                <nz-tab nzTitle="Quotes" (nzClick)="view(10)"> </nz-tab>                
            </nz-tabset>
        </div>
    
        <nz-empty *ngIf="user == null" style="margin-top:8rem"
            nzNotFoundImage="https://gw.alipayobjects.com/zos/antfincdn/ZHrcdLPrvN/empty.svg" [nzNotFoundContent]="contentTpl">
            <ng-template #contentTpl>
                <p>Select Recipient</p>
            </ng-template>
        </nz-empty>
        
        <div nz-col nzSpan="24">
            <router-outlet></router-outlet>
        </div>
    </div>
    
</div>

<app-add-quote [open]="newQuoteModal" [user]="user" [option]="option"></app-add-quote>

<app-add-referral [open]="newReferralModal" [type]="'referral'" (openRefer)="openReferModal($event)" ></app-add-referral>

<app-refer-in [open]="openReferInModal"></app-refer-in>

<app-recipients-options [open]="recipientOptionOpen" [option]="recipientOption" [user]="user" [from]="from"></app-recipients-options>


<nz-modal [(nzVisible)]="programModalOpen" nzWidth="920" nzTitle="Alert Status and Usage Analysis" (nzOnCancel)="closeProgram()" (nzOnOk)="closeProgram()">
    <div nz-row>
       <div nz-row>
        <nz-table #fixedTable [nzData]="programs" nzSize="small" [nzScroll]="{ x: '1150px', y: '240px' }">
            <thead>
              <tr>
                <th nzWidth="150px" nzLeft="0px">Program</th>
                <th nzWidth="100px" nzLeft="150px">Allowed</th>
                <th nzWidth="100px">Used</th>
                <th nzWidth="100px">Balance</th>
                <th nzWidth="100px">Red Alert</th>
                <th nzWidth="100px">Yellow Alert</th>
                <th nzWidth="100px">Green Alert</th>
                <th nzWidth="100px">Expires On</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let data of fixedTable.data">
                <td nzLeft="0px">{{ data.program }}</td>
                <td nzLeft="150px">{{ data.allowed }}</td>
                <td>{{ data.address }}</td>
                <td>{{ data.balance }}</td>
                <td>{{ data.redAmount }}</td>
                <td>{{ data.yellowAmount }}</td>
                <td>{{ data.greenAmount }}</td>
                <td>{{ data.alertStartDate }}</td>               
              </tr>
            </tbody>
          </nz-table>
       </div>
    </div>
</nz-modal>



<nz-modal [(nzVisible)]="findModalOpen" [nzStyle]="{ top: '20px' }" nzWidth="1340" nzTitle="Change Service Profile" (nzOnCancel)="handleCancel()" (nzOnOk)="handleOk()">
    <div *ngIf="findModalOpen">
        <nz-tabset [nzTabPosition]="'top'" [nzType]="'card'">
            <nz-tab nzTitle="Quick Search" (nzClick)="tabFindChange(0)"> </nz-tab>
            <nz-tab nzTitle="Filters" (nzClick)="tabFindChange(1)"> </nz-tab>
            <nz-tab nzTitle="Extended Search" (nzClick)="tabFindChange(2)"></nz-tab>
        </nz-tabset>

        <div>
            <div *ngIf="tabFindIndex == 0"  nz-row nzGutter="32">
                <div nz-col nzSpan="5">
                    <div nz-row>
                        <div nz-col nzSpan="12">
                            <label class="columns" nz-checkbox>Active</label>
                        </div>
                        <div nz-col nzSpan="12">
                            <label class="columns" nz-checkbox>Inactive</label>
                        </div>
                    </div>
                    <div nz-row>
                        <div nz-row>
                            <div nz-col style="margin:10px">
                                <label class="columns" nz-checkbox>REFERRAL</label>
                                <label class="columns" nz-checkbox>WAITING LIST</label>
                                <label class="columns" nz-checkbox>RECIPIENT</label>
                                <label class="columns" nz-checkbox>CARER</label>
                                <label class="columns" nz-checkbox>CARER/RECIPIENT</label>
                                <label class="columns" nz-checkbox>BILLING CLIENT</label>
                                <label class="columns" nz-checkbox>ASSOCIATE</label>
                            </div>
                        </div>
                        <div nz-row>
                            <input nz-input placeholder="Surname" [(ngModel)]="value" />
                        </div>
                        <div nz-row>
                            <input nz-input placeholder="First Name" [(ngModel)]="value" />
                        </div>
                        <div nz-row>
                            <input nz-input placeholder="Phone #" [(ngModel)]="value" />
                        </div>
                        <div nz-row>
                            <input nz-input placeholder="Suburb" [(ngModel)]="value" />
                        </div>
                        <div nz-row>
                            <input nz-input placeholder="Date Of Birth" [(ngModel)]="value" />
                        </div>
                        <div nz-row>
                            <input nz-input placeholder="File #" [(ngModel)]="value" />
                        </div>
                    </div>
                </div>
                <div nz-col nzSpan="18">
                    <div nz-row>
                        <input nz-input placeholder="Type SURNAME here and press enter" [(ngModel)]="value" />
                    </div>
                </div>
            </div>
    
            <div *ngIf="tabFindIndex == 1" nz-row nzGutter="16">
                <div nz-col nzSpan="4">
                    <label class="columns" nz-checkbox *ngFor="let list of columns" [(ngModel)]="list.checked">{{ list.name }}</label>
                </div>
                <div nz-col nzSpan="20">
                    <h4>Quick Filters</h4>
                    <nz-tabset [nzTabPosition]="'top'" [nzType]="'card'">
                        <nz-tab nzTitle="Branches" (nzClick)="filterChange(0)"> </nz-tab>
                        <nz-tab nzTitle="Programs" (nzClick)="filterChange(1)"> </nz-tab>
                        <nz-tab nzTitle="Case Coordinators" (nzClick)="filterChange(2)"></nz-tab>
                        <nz-tab nzTitle="Categories" (nzClick)="filterChange(3)"></nz-tab>
                    </nz-tabset>
                </div>
            </div>
    
            <div nz-row *ngIf="tabFindIndex == 2" nzGutter="16">
                
                <div nz-col nzSpan="8" class="tree-overflow">
                    <nz-tree [nzData]="nodes" nzShowLine (nzClick)="nzEvent($event)"> </nz-tree>
                </div>

                <div nz-col nzSpan="16">
                    <div nz-row>
                        <div class="form-group">
                            <input nz-input placeholder="Basic usage" [(ngModel)]="value" />
                        </div>
                    </div>
                    <div nz-row nzGutter="16">
                        <div nz-col nzSpan="10" class="form-group">
                            <ng-select 
                                [items]="sampleList" 
                                [virtualScroll]="true"
                                [dropdownPosition]="'bottom'"
                                [clearable]="false"
                        
                                [closeOnSelect]="true"
                                [(ngModel)]="sampleModel">
                            </ng-select>
                        </div>
                        <div nz-col nzSpan="10" class="form-group">
                            <input nz-input placeholder="Basic usage" [(ngModel)]="value" />
                        </div>
                    </div>
                    <div nz-row>
                        <nz-table #smallTable nzSize="small" [nzData]="data">
                            <thead>
                              <tr>
                                <th>Name</th>
                                <th>Age</th>
                                <th>Address</th>
                              </tr>
                            </thead>
                            <tbody>
                              <tr *ngFor="let data of smallTable.data">
                                <td>{{ data.name }}</td>
                                <td>{{ data.age }}</td>
                                <td>{{ data.address }}</td>
                              </tr>
                            </tbody>
                          </nz-table>
                    </div>
                </div>
    
            </div>
        </div>
    </div>
</nz-modal>

<nz-modal [(nzVisible)]="referdocument" [nzStyle]="{top: '20px'}" nzWidth="600"   nzTitle="Add Referral Document" (nzOnCancel)="handleCancel()" (nzOnOk)="handleOk()"  >
<div nz-row *ngIf="referdocument">
    <div nz-col nzSpan="16">
        <nz-upload nzType="drag" [nzMultiple]="true" [nzLimit]="2" [nzAccept]="acceptedTypes" 
             [nzAction]="urlPath" (nzChange)="handleChange($event)" nzListType="picture"
            [(nzFileList)]="fileList2">

            <p class="ant-upload-drag-icon">
                <i nz-icon nzType="inbox"></i>
            </p>
            <p class="ant-upload-text">Click or drag file to this area to upload</p>
            <p class="ant-upload-hint">
                Support for a single or bulk upload. Strictly prohibit from uploading company data or other band files
            </p>
        </nz-upload>
    </div>
</div>
<div *nzModalFooter>
    <ng-container>
        <button nz-button nzType="default" (click)="handleCancel()">Cancel</button>
        <button nz-button nzType="primary" (click)="customReq()">Save</button>
    </ng-container> 
</div>
</nz-modal>