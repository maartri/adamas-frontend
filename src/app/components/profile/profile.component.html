<ng-container *ngIf="!isAdmin" >
    <div class="space-top" style="margin:3rem 0">
        <div class="form-group">
            <!-- <label for="" class="info">Profile Information</label> -->
            <div class="edit-btn">
                <div class="right-btns">
                    <button *ngIf="showMailManagerBtn" (click)="emailManager()" nz-button nzType="default"><i nz-icon
                            nzType="mail" nzTheme="outline"></i> EMAIL Manager</button>
                    <button nz-button nzType="primary" nzValue="small" (click)="editProfileOpen()"><i nz-icon style="color:#fff" nzType="edit"
                            nzTheme="outline"></i> Edit Profile</button>
                </div>
            </div>
            <div class="space-top">
                <div nz-row>
                    <div class="avatar-container" [class.alert-show]="showUpload" (mouseover)="showUpload=true"
                        (mouseleave)="showUpload=false">
                        <img *ngIf="showAvatar == false" [src]="imgSrc" alt="" (error)="errorUrl($event)">
                        <nz-avatar *ngIf="showAvatar == true"  [nzShape]="'square'" [nzSize]="64" nzIcon="user"></nz-avatar>
                    
                        <div class="prof-alert" (click)="changeProfilePicture()">
                            <i class="material-icons"> photo_camera </i>
                            Upload
                        </div>
                    </div>
                    <div class="form-group">
                        <h3>{{ user?.uniqueID || '-' }}</h3>
                        <h2 class="highlight">{{ user?.title  | titlecase  }} {{ user?.firstName  | titlecase  }} {{ user?.middleNames | titlecase  }} {{ (user?.lastName || user?.surnameOrg)  | titlecase   }}<span
                                *ngIf="user?.preferredName" style="color:#8c928e">({{ user?.preferredName }})</span></h2>
                    </div>
                </div>                
                <div nz-row nzGutter="16">
                    <div nz-col nzSpan="4">
                        <div class="form-group">
                            <label class="highlight"><i nz-icon class="icon" nzType="calendar" nzTheme="outline"></i> Birthdate</label>
                            <span *ngIf="innerValue?.view === view.recipient">{{ user?.dateOfBirth | date: 'dd / MM / yyyy' || '-' }}</span>
                            <span *ngIf="innerValue?.view === view.staff">{{ user?.dob | date: 'dd / MM / yyyy' || '-' }}</span>
                        </div>
                    </div>
                    <div nz-col nzSpan="4">
                        <div class="form-group">
                            <label class="highlight"><i nz-icon class="icon" nzType="woman" nzTheme="outline"></i> Gender</label>
                            <span>{{ user?.gender }}</span>
                        </div>
                    </div>
                    <div nz-col nzSpan="4">
                        <div class="form-group">
                            <label class="highlight"><i nz-icon class="icon" nzType="alert" nzTheme="outline"></i> Case Manager</label>
                            <span>{{ user?.recipient_Coordinator || '-' }}</span>
                        </div>
                    </div>
                </div>
                <!-- <nz-descriptions [nzSize]="'small'" [nzColumn]="{ xxl: 4, xl: 4, lg: 4, md: 4, sm: 2, xs: 1 }"
                    [nzColon]="false" nzTitle="" nzLayout="vertical">
                    <nz-descriptions-item nzTitle="Title"><b>{{ user?.title || '-' }}</b></nz-descriptions-item>
                    <nz-descriptions-item nzTitle="Lastname">
                        <b *ngIf="innerValue?.view === view.recipient">{{ user?.surnameOrg || '-' }}</b>
                        <b *ngIf="innerValue?.view === view.staff">{{ user?.lastName || '-' }}</b>
                    </nz-descriptions-item>
                    <nz-descriptions-item nzTitle="Firstname"><b>{{ user?.firstName || '-' }}</b></nz-descriptions-item>
                    <nz-descriptions-item nzTitle="Middlename"><b>{{ user?.middleNames || '-' }}</b></nz-descriptions-item>
                    <nz-descriptions-item nzTitle="Gender"><b>{{ user?.gender || '-' }}</b></nz-descriptions-item>
                    <nz-descriptions-item nzTitle="Birthdate">
                        <b *ngIf="innerValue?.view === view.recipient">{{ user?.dateOfBirth | date }}</b>
                        <b *ngIf="innerValue?.view === view.staff">{{ user?.dob | date }}</b>
                    </nz-descriptions-item>
                    <nz-descriptions-item *ngIf="innerValue?.view === view.recipient" nzTitle="Case Manager">
                        <b>{{ user?.recipient_Coordinator || '-' }}</b>
                    </nz-descriptions-item>
                </nz-descriptions> -->
            </div>
        </div>
    </div>

    <div class="space-top">
        <div class="form-group">
            <label for="" class="info"><i class="material-icons icon"> location_on </i> Address Information</label>
            <div class="edit-btn">
                <div class="right-btns">
                    <button nz-button nzType="default" nzValue="small" (click)="addAddressOpen()" class="right"><i nz-icon
                            nzType="plus" nzTheme="outline"></i> Add Address</button>
                </div>
            </div>
            <ul style="width: 50%;">
                <li *ngFor="let data of user?.addresses">
                    <div class="options">
                        <i nz-icon nzType="edit" nzTooltipTitle="Update" nz-tooltip nzTooltipPlacement="top" nzTheme="outline"
                            class="neutral" (click)="editAddressOpen(data)"></i>
                        <i nz-icon nzType="delete" class="neutral" nz-tooltip nzTooltipTitle="Delete" nzTooltipPlacement="top"
                            nzTheme="outline" nz-popconfirm nzPopconfirmTitle="Are you sure delete this address?"
                            nzPopconfirmPlacement="bottom" (nzOnConfirm)="confirm(1,data)" (nzOnCancel)="cancel(1)"></i>
                    </div>
                    <div> {{ data.address1 }}, {{ data.suburb}} {{ data.postCode }}</div>
                    <b>{{ data.description }} </b>
                </li>
            </ul>
            <!-- <nz-table #basicTable [nzData]="user?.addresses" [nzSize]="'small'" [nzFrontPagination]="false"
                [nzShowPagination]="false">
                <thead>
                    <tr>
                        <th>Description</th>
                        <th>Address</th>
                        <th>Suburb</th>
                        <th>Postcode</th>
                        <th>Action</th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let data of basicTable.data">
                        <td>{{ data.description }}</td>
                        <td>{{ data.address1 }}</td>
                        <td>{{ data.suburb }}</td>
                        <td>{{ data.postCode }}</td>
                        <td>
                            <a (click)="editAddressOpen(data)">Edit</a>
                            <nz-divider nzType="vertical"></nz-divider>
                            <a nz-popconfirm nzPopconfirmTitle="Are you sure delete this address?"
                                nzPopconfirmPlacement="bottom" (nzOnConfirm)="confirm(1,data)"
                                (nzOnCancel)="cancel(1)">Delete</a>
                        </td>
                    </tr>
                </tbody>
            </nz-table> -->
        </div>
    
        <div class="form-group space-top">
            <label for="" class="info"><i class="material-icons icon"> phone </i> Contact Information</label>
            <div class="edit-btn">
                <div class="right-btns">
                    <button nz-button nzType="default" nzValue="small" (click)="addContactOpen()" class="right"><i nz-icon
                            nzType="plus" nzTheme="outline"></i> Add Contact</button>
                </div>
            </div>
            <!-- <nz-table #contactTable [nzData]="user?.contacts" [nzSize]="'small'" [nzFrontPagination]="false"
                [nzShowPagination]="false">
                <thead>
                    <tr>
                        <th>Type</th>
                        <th>Detail</th>
                        <th>Action</th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let data of contactTable.data">
                        <td>{{ data.type }}</td>
                        <td>{{ data.detail }}</td>
                        <td>
                            <a (click)="editContactOpen(data)">Edit</a>
                            <nz-divider nzType="vertical"></nz-divider>
                            <a nz-popconfirm nzPopconfirmTitle="Are you sure delete this contact?"
                                nzPopconfirmPlacement="bottom" (nzOnConfirm)="confirm(2, data)"
                                (nzOnCancel)="cancel(2)">Delete</a>
                        </td>
                    </tr>
                </tbody>
            </nz-table> -->
            <ul style="width: 50%;">
                <li *ngFor="let data of user?.contacts">
                    <div class="options">
                        <i nz-icon nzType="edit" nzTooltipTitle="Update" (click)="editContactOpen(data)" nz-tooltip
                            nzTooltipPlacement="top" nzTheme="outline" class="neutral"></i>
                        <i nz-icon nzType="delete" class="neutral" nz-tooltip nzTooltipTitle="Delete" nzTooltipPlacement="top"
                            nzTheme="outline" nz-popconfirm nzPopconfirmTitle="Are you sure delete this contact?"
                            nzPopconfirmPlacement="bottom" (nzOnConfirm)="confirm(2, data)" (nzOnCancel)="cancel(2)"></i>
                    </div>
                    <div>{{ data.detail }}</div>
                    <b>{{ data.type }}</b>
                </li>
            </ul>
        </div>
    </div>
</ng-container>


<ng-container *ngIf="isAdmin">
    <div nz-row style="margin-top:2rem; background:#fff" nzGutter="16">

        <ng-container *ngIf="this.innerValue?.view == 'staff'">
            <div nz-col nzSpan="12">
                <div nz-row class="divider">
                    <i nz-icon nzType="edit" nzTheme="outline" (click)="profileStaffModal = true;patchTheseValuesInForm()"></i>
                    <div nz-row>
                        <div class="avatar-container" [class.alert-show]="showUpload" (mouseover)="showUpload=true" (mouseleave)="showUpload=false">
                            <img *ngIf="showAvatar == false" [src]="imgSrc" alt="" (error)="errorUrl($event)">
                            <nz-avatar *ngIf="showAvatar == true" [nzShape]="'square'" [nzSize]="64" nzIcon="user"></nz-avatar>

                            <div class="prof-alert" (click)="changeProfilePicture()">
                                <i class="material-icons"> photo_camera </i>
                                Upload
                            </div>
                        </div>
                        <div class="form-group">
                            <h3>{{ user?.uniqueID || '-' }}</h3>
                            <h2 class="highlight">{{ user?.title | titlecase }} {{ user?.firstName  | titlecase }} {{ user?.middleNames | titlecase }} {{ user?.lastName | titlecase }}<span *ngIf="user?.preferredName" style="color:#8c928e">({{ user?.preferredName }})</span></h2>
                        </div>
                    </div>
                    <div nz-row nzGutter="16">
                        <div nz-col nzSpan="12">
                            <div class="form-group">
                                <label class="highlight"><i nz-icon nzType="calendar" nzTheme="outline"></i> Birthdate</label>
                                <span>{{ user?.dob | date: 'dd / MM / yyyy' || '-' }}</span>
                            </div>
                        </div>
                        <div nz-col nzSpan="12">
                            <div class="form-group">
                                <label class="highlight"><i nz-icon nzType="woman" nzTheme="outline"></i> Gender</label>
                                <span>{{ user?.gender }}</span>
                            </div>
                        </div>
                    </div>
                    <!-- <div nz-row nzGutter="16">                        
                        <div nz-col nzSpan="12">
                            <div class="form-group">
                                <label class="highlight"><i nz-icon nzType="calendar" nzTheme="outline"></i> Birthdate</label>
                                <span>{{ user?.dob | date: 'dd / MM / yyyy' || '-' }}</span>
                            </div>
                        </div>
                    </div> -->
                    <hr>
                    <div nz-row *ngIf="staffrecordview && staffrecordview[16] == '1'">
                        <div class="form-group">
                            <div>
                                <label class="highlight"><i class="material-icons "> location_on </i>Address </label>
                                <i nz-icon nzType="plus" nzTooltipTitle="Add Address" (click)="addAddressOpen()" nz-tooltip nzTooltipPlacement="top" nzTheme="outline"
                                    class="color-powder-blue add"></i>
                            </div>                           
                            <ul>
                                <li *ngFor="let data of user?.addresses">
                                    <div class="options">
                                        <i class="material-icons neutral" (click)="toMap(data)" style="font-size:17px;"> location_on </i>
                                        <!-- <i nz-icon nzType="edit" nzTooltipTitle="Update" nz-tooltip nzTooltipPlacement="top" nzTheme="outline" class="neutral" (click)="editAddressOpen(data)"></i>
                                        <i nz-icon nzType="delete" class="neutral" nz-tooltip nzTooltipTitle="Delete" nzTooltipPlacement="top" nzTheme="outline"  nz-popconfirm nzPopconfirmTitle="Are you sure delete this address?"
                                            nzPopconfirmPlacement="bottom" (nzOnConfirm)="confirm(1,data)"
                                            (nzOnCancel)="cancel(1)"></i>  -->

                                        <i nzType="edit" nzTooltipTitle="Update" nz-tooltip nzTooltipPlacement="top" nzTheme="outline" class="neutral" style="font-style: normal" (click)="editAddressOpen(data)">Update</i>                                            
                                            <nz-divider nzType="vertical"></nz-divider>
                                        <i nzType="delete" class="neutral" nz-tooltip nzTooltipTitle="Delete" nzTooltipPlacement="top" style="font-style: normal" nzTheme="outline"  nz-popconfirm nzPopconfirmTitle="Are you sure delete this address?"
                                            nzPopconfirmPlacement="bottom" (nzOnConfirm)="confirm(1,data)"
                                            (nzOnCancel)="cancel(1)">Delete</i>                                        
                                    </div>
                                    <div> {{ data.address1 }} {{ data.suburb}} {{ data.postCode }} </div>
                                    <b>{{ data.description }}</b>
                                </li>
                                <li *ngIf="user?.addresses?.length == 0">
                                    <nz-alert nzType="warning" nzMessage="No Addresses" nzShowIcon></nz-alert>
                                </li>
                            </ul>

                        </div>
                    </div>
                    <div nz-row *ngIf="staffrecordview && staffrecordview[17] == '1' ">
                        <div class="form-group">
                            <div>
                                <label class="highlight"><i class="material-icons"> phone </i>Contacts</label>
                                <i nz-icon nzType="plus" nzTooltipTitle="Add Contact" (click)="addContactOpen()" nz-tooltip nzTooltipPlacement="top" nzTheme="outline"
                                    class="color-powder-blue add"></i>
                            </div>
                            <ul>
                                <li *ngFor="let data of user?.contacts">
                                    <div class="options">                                        
                                        <!-- <i nz-icon nzType="edit" nzTooltipTitle="Update" (click)="editContactOpen(data)" nz-tooltip nzTooltipPlacement="top" nzTheme="outline" class="neutral"></i>
                                        <i nz-icon nzType="delete" class="neutral" nz-tooltip nzTooltipTitle="Delete" nzTooltipPlacement="top"
                                            nzTheme="outline" nz-popconfirm nzPopconfirmTitle="Are you sure delete this contact?"
                                            nzPopconfirmPlacement="bottom" (nzOnConfirm)="confirm(2, data)"
                                            (nzOnCancel)="cancel(2)"></i> -->

                                 

                                        <i nzType="edit" nzTooltipTitle="Update" style="font-style: normal" (click)="editContactOpen(data)" nz-tooltip nzTooltipPlacement="top" nzTheme="outline" class="neutral">Update</i>                                            
                                            <nz-divider nzType="vertical"></nz-divider>
                                        <i nzType="delete" class="neutral" style="font-style: normal" nz-tooltip nzTooltipTitle="Delete" nzTooltipPlacement="top"
                                            nzTheme="outline" nz-popconfirm nzPopconfirmTitle="Are you sure delete this contact?"
                                            nzPopconfirmPlacement="bottom" (nzOnConfirm)="confirm(2, data)"
                                            (nzOnCancel)="cancel(2)">Delete</i>
                                    </div>
                                    <div>{{ data.detail }}</div>
                                    <b>{{ data.type }}</b>
                                </li>
                                <li *ngIf="user?.contacts?.length == 0">
                                    <nz-alert nzType="warning" nzMessage="No Contacts" nzShowIcon></nz-alert>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>                
            </div>
            
            <div nz-col nzSpan="12">
                <div nz-row class="divider sec-highlight">
                    <i nz-icon nzType="edit" nzTheme="outline" (click)="profileStaffOptionsModal=true;patchTheseValuesInForm()"></i>
                    <nz-descriptions nzLayout="vertical" [nzColon]="false" [nzColumn]=2 *ngIf="user">
                        <nz-descriptions-item nzTitle="Type">{{ user?.category || '-' }}</nz-descriptions-item>
                        <nz-descriptions-item nzTitle="Staff #">{{ user?.stf_Code || '-' }}</nz-descriptions-item>
                        <nz-descriptions-item nzTitle="Branch/Department">{{ user?.stf_Department || '-' }}</nz-descriptions-item>
                        <nz-descriptions-item nzTitle="Job Category">{{ user?.staffGroup || '-' }}</nz-descriptions-item>
                        <nz-descriptions-item nzTitle="Admin Category">{{ user?.subCategory || '-' }}</nz-descriptions-item>
                        <nz-descriptions-item nzTitle="Team/Area">{{ user?.staffTeam || '-' }}</nz-descriptions-item>
                        <nz-descriptions-item nzTitle="Coordinator/Manager">{{ user?.pan_Manager || '-' }}</nz-descriptions-item>
                        <nz-descriptions-item nzTitle="Service Region">{{ user?.serviceRegion || '-' }}</nz-descriptions-item>
                        <nz-descriptions-item nzTitle="Grid #">{{ user?.ubdMap || '-' }}</nz-descriptions-item>
                        <nz-descriptions-item nzTitle="Driver's License">{{ user?.dLicence || '-' }}</nz-descriptions-item>
                        <nz-descriptions-item nzTitle="MV Reg">{{ user?.vRegistration || '-' }}</nz-descriptions-item>
                        <nz-descriptions-item nzTitle="Rating">
                            <nz-rate [ngModel]="user?.rating" [nzCount]="7" nzDisabled></nz-rate>
                        </nz-descriptions-item>
                        <nz-descriptions-item nzTitle="N Registration #">{{ user?.nRegistration || '-' }}</nz-descriptions-item>
                        <nz-descriptions-item nzTitle="Has Caseload"><label nz-checkbox nzDisabled [ngModel]="user?.caseManager" nzDisabled ></label></nz-descriptions-item>
                        <nz-descriptions-item nzTitle="Is Rosterable"><label nz-checkbox nzDisabled [ngModel]="user?.isRosterable" nzDisabled ></label></nz-descriptions-item>
                        <nz-descriptions-item nzTitle="Email Timesheet"><label nz-checkbox nzDisabled [ngModel]="user?.emailTimesheet" nzDisabled ></label></nz-descriptions-item>
                        <nz-descriptions-item nzTitle="Exclude From Roaster Conflict Checking"><label nz-checkbox nzDisabled [ngModel]="user?.excludeFromConflictChecking" nzDisabled ></label></nz-descriptions-item>
                        

                    </nz-descriptions>
                </div>

                <div nz-row class="divider sec-highlight">
                
                    <i nz-icon nzType="edit" nzTheme="outline"
                        (click)="profileStaffPreferredModal = true;patchTheseValuesInForm();"></i>
                    <div nz-col nzSpan="11" *ngIf="staffrecordview && staffrecordview[15] == '1'">
                        <nz-descriptions nzLayout="vertical" [nzColon]="false" [nzColumn]=1>
                            <nz-descriptions-item nzTitle="Preferred Availability/Notes">
                                <textarea rows="4" style="height: 174px; width: 13rem;" nz-input [ngModel]="user?.contactIssues"
                                    readonly></textarea>
                            </nz-descriptions-item>
                        </nz-descriptions>
                    </div>
                    <div nz-col nzSpan="13">
                        <nz-descriptions nzLayout="vertical" [nzColon]="false" [nzColumn]=1>
                            <nz-descriptions-item nzTitle="Cald Status">{{ user?.caldStatus || '-' }}</nz-descriptions-item>
                            <nz-descriptions-item nzTitle="Indigenous Status">{{ user?.cstda_Indiginous || '-' }}
                            </nz-descriptions-item>
                            <nz-descriptions-item nzTitle="Primary Disability">{{ user?.cstda_DisabilityGroup || '-' }}
                            </nz-descriptions-item>
                        </nz-descriptions>
                    </div>
                </div>
                
            </div>
        </ng-container>

        <ng-container *ngIf="this.innerValue?.view == 'recipient' ">
            <div nz-col nzSpan="24">
                <div nz-col nzSpan="24">
                   <b style="margin-right:1rem">Active In :</b>
                   <span class="active-programs" *ngFor="let data of activePrograms">{{ data }}</span>
                </div>
            </div>
            <div nz-col nzSpan="12">
                <div nz-row class="divider">
                    <i nz-icon nzType="edit" nzTheme="outline" (click)="profileStaffModal = true;patchTheseValuesInForm()"></i>
  
                    <div nz-row>
                        <div class="avatar-container" [class.alert-show]="showUpload" (mouseover)="showUpload=true"
                            (mouseleave)="showUpload=false">
                            <img *ngIf="showAvatar == false" [src]="imgSrc" alt="" (error)="errorUrl($event)">
                            <nz-avatar *ngIf="showAvatar == true" [nzShape]="'square'" [nzSize]="64" nzIcon="user"></nz-avatar>
                        
                            <div class="prof-alert" (click)="changeProfilePicture()">
                                <i class="material-icons"> photo_camera </i>
                                Upload
                            </div>                          
                        </div>
                        <div class="form-group">
                            <h3>{{ user?.uniqueID || '-' }}</h3>
                            <h2 class="highlight">{{ user?.title }} {{ user?.firstName }} {{ user?.middleNames }} {{ user?.surnameOrg }}<span *ngIf="user?.preferredName" style="color:#8c928e">({{ user?.preferredName }})</span></h2>
                        </div>
                    </div>

                    <div nz-row nzGutter="16">
                        <div nz-col nzSpan="12">
                            <div class="form-group">
                                <label class="highlight"><i nz-icon nzType="woman" nzTheme="outline"></i> Gender</label>
                                <span>{{ (user?.gender) ? user?.gender : '*'  }}</span>
                            </div>
                        </div>
                        <div nz-col nzSpan="12">
                            <div class="form-group">
                                <label class="highlight"><i nz-icon nzType="calendar" nzTheme="outline"></i> Birthdate</label>
                                <span>{{ (user?.dateOfBirth) ? (user?.dateOfBirth | date: 'dd / MM / yyyy') : '*'}}</span>
                            </div>
                        </div>
                    </div>

                    <div nz-row>
                        <div class="form-group">
                            <div>
                                <label class="highlight"><i class="material-icons"> location_on </i>Address</label>
                                <i nz-icon nzType="plus" nzTooltipTitle="Add Address" (click)="addAddressOpen()" nz-tooltip nzTooltipPlacement="top"
                                    nzTheme="outline" class="color-powder-blue add"></i>
                            </div>
                            <ul>
                                <li *ngFor="let data of user?.addresses">
                                    <div class="options">
                                        <!-- <i nz-icon nzType="edit" nzTooltipTitle="Update" nz-tooltip nzTooltipPlacement="top" nzTheme="outline"
                                            class="neutral" (click)="editAddressOpen(data)"></i> -->
                                        <!-- <i nz-icon nzType="delete" class="neutral" nz-tooltip nzTooltipTitle="Delete" nzTooltipPlacement="top"
                                            nzTheme="outline" nz-popconfirm nzPopconfirmTitle="Are you sure delete this address?"
                                            nzPopconfirmPlacement="bottom" (nzOnConfirm)="confirm(1,data)" (nzOnCancel)="cancel(1)"></i> -->

                                        <i nzType="edit" nzTooltipTitle="Update" nz-tooltip nzTooltipPlacement="top" nzTheme="outline"
                                            class="neutral" (click)="editAddressOpen(data)" style="font-style: normal">Update</i>                                            
                                            <nz-divider nzType="vertical"></nz-divider>
                                        <i nzType="delete" class="neutral" style="font-style: normal" nz-tooltip nzTooltipTitle="Delete" nzTooltipPlacement="top"
                                            nzTheme="outline" nz-popconfirm nzPopconfirmTitle="Are you sure delete this address?"
                                            nzPopconfirmPlacement="bottom" (nzOnConfirm)="confirm(1,data)" (nzOnCancel)="cancel(1)">Delete</i>
                                    </div>
                                    <div>
                                        <i nz-icon class="primary-icon" [class.primary]="data.primaryAddress"  nzTooltipTitle="Primary">
                                            <svg>
                                              <path
                                                d="M923 283.6c-13.4-31.1-32.6-58.9-56.9-82.8-24.3-23.8-52.5-42.4-84-55.5-32.5-13.5-66.9-20.3-102.4-20.3-49.3 0-97.4 13.5-139.2 39-10 6.1-19.5 12.8-28.5 20.1-9-7.3-18.5-14-28.5-20.1-41.8-25.5-89.9-39-139.2-39-35.5 0-69.9 6.8-102.4 20.3-31.4 13-59.7 31.7-84 55.5-24.4 23.9-43.5 51.7-56.9 82.8-13.9 32.3-21 66.6-21 101.9 0 33.3 6.8 68 20.3 103.3 11.3 29.5 27.5 60.1 48.2 91 32.8 48.9 77.9 99.9 133.9 151.6 92.8 85.7 184.7 144.9 188.6 147.3l23.7 15.2c10.5 6.7 24 6.7 34.5 0l23.7-15.2c3.9-2.5 95.7-61.6 188.6-147.3 56-51.7 101.1-102.7 133.9-151.6 20.7-30.9 37-61.5 48.2-91 13.5-35.3 20.3-70 20.3-103.3 0.1-35.3-7-69.6-20.9-101.9z"
                                              />
                                            </svg>
                                          </i>
                                          {{ data.address1 }}, {{ data.suburb}} {{ data.postCode }} </div>
                                    <b>{{ data.description }}</b>
                                </li>
                                <li *ngIf="user?.addresses?.length == 0">
                                    <nz-alert nzType="warning" nzMessage="No Addresses" nzShowIcon></nz-alert>
                                </li>
                            </ul>
                           
                        </div>
                    </div>
                    <div nz-row>
                        <div class="form-group">
                            <div>
                                <label class="highlight"><i class="material-icons"> phone </i>Contacts</label>
                                <i nz-icon nzType="plus" nzTooltipTitle="Add Contact" (click)="addContactOpen()" nz-tooltip nzTooltipPlacement="top"
                                    nzTheme="outline" class="color-powder-blue add"></i>
                            </div>
                            <ul>
                                <li *ngFor="let data of user?.contacts">
                                    <div class="options">
                                        <!-- <i nz-icon nzType="edit" nzTooltipTitle="Update" (click)="editContactOpen(data)" nz-tooltip nzTooltipPlacement="top"
                                            nzTheme="outline" class="neutral"></i>
                                        <i nz-icon nzType="delete" class="neutral" nz-tooltip nzTooltipTitle="Delete" nzTooltipPlacement="top"
                                            nzTheme="outline" nz-popconfirm nzPopconfirmTitle="Are you sure delete this contact?"
                                            nzPopconfirmPlacement="bottom" (nzOnConfirm)="confirm(2, data)" (nzOnCancel)="cancel(2)"></i> -->

                                            <!-- {{ data | json }} -->

                                           

                                        <i nzType="edit" nzTooltipTitle="Update" (click)="editContactOpen(data)" nz-tooltip nzTooltipPlacement="top"
                                            nzTheme="outline" class="neutral" style="font-style: normal">Update</i>                                          
                                            <nz-divider nzType="vertical"></nz-divider>
                                        <i nzType="delete" class="neutral" style="font-style: normal" nz-tooltip nzTooltipTitle="Delete" nzTooltipPlacement="top"
                                            nzTheme="outline" nz-popconfirm nzPopconfirmTitle="Are you sure delete this contact?"
                                            nzPopconfirmPlacement="bottom" (nzOnConfirm)="confirm(2, data)" (nzOnCancel)="cancel(2)">Delete</i>
                                    </div>
                                   
                                    <div>
                                        <i nz-icon class="primary-icon" [class.primary]="data.primaryPhone"  nzTooltipTitle="Primary">
                                            <svg>
                                              <path
                                                d="M923 283.6c-13.4-31.1-32.6-58.9-56.9-82.8-24.3-23.8-52.5-42.4-84-55.5-32.5-13.5-66.9-20.3-102.4-20.3-49.3 0-97.4 13.5-139.2 39-10 6.1-19.5 12.8-28.5 20.1-9-7.3-18.5-14-28.5-20.1-41.8-25.5-89.9-39-139.2-39-35.5 0-69.9 6.8-102.4 20.3-31.4 13-59.7 31.7-84 55.5-24.4 23.9-43.5 51.7-56.9 82.8-13.9 32.3-21 66.6-21 101.9 0 33.3 6.8 68 20.3 103.3 11.3 29.5 27.5 60.1 48.2 91 32.8 48.9 77.9 99.9 133.9 151.6 92.8 85.7 184.7 144.9 188.6 147.3l23.7 15.2c10.5 6.7 24 6.7 34.5 0l23.7-15.2c3.9-2.5 95.7-61.6 188.6-147.3 56-51.7 101.1-102.7 133.9-151.6 20.7-30.9 37-61.5 48.2-91 13.5-35.3 20.3-70 20.3-103.3 0.1-35.3-7-69.6-20.9-101.9z"
                                              />
                                            </svg>
                                          </i>
                                          {{ data.detail }}
                                    </div>
                                    <b>{{ data.type }}</b>
                                    
                                </li>
                                <li *ngIf="user?.contacts?.length == 0">
                                    <nz-alert nzType="warning" nzMessage="No Contacts" nzShowIcon></nz-alert>
                                </li>
                            </ul>
                        </div>
                    </div>

                </div>               
            </div>
            <div nz-col nzSpan="12">
                <div nz-row class="divider sec-highlight">
                    <i nz-icon nzType="edit" nzTheme="outline" (click)="profileRecipientOptionsModal=true;patchTheseValuesInForm()"></i>
                    <nz-descriptions nzLayout="vertical" [nzColon]="false" [nzColumn]=2 *ngIf="user">
                        <nz-descriptions-item nzTitle="File #1">{{ user?.agencyIdReportingCode || '-' }}</nz-descriptions-item>
                        <nz-descriptions-item nzTitle="File #2">{{ user?.urNumber || '-' }}</nz-descriptions-item>
                        <nz-descriptions-item nzTitle="Admitting Branch">{{ user?.branch || '-' }}</nz-descriptions-item>
                        <nz-descriptions-item nzTitle="Service Region/Main Category">{{ user?.agencyDefinedGroup || '-' }}</nz-descriptions-item>
                        <nz-descriptions-item nzTitle="Sub Category">{{ user?.ubdMap || '-' }}</nz-descriptions-item>
                        <nz-descriptions-item nzTitle="Primary Case Manager">{{ user?.recipient_Coordinator || '-' }}</nz-descriptions-item>                       
                    </nz-descriptions>
                </div>

                <div nz-row class="divider sec-highlight">
                    <button class="botton recordHeaderMainButtons" (click)="saveTab()">Save</button>
                    <nz-tabset (nzSelectedIndexChange)="tabChange($event)" [nzSelectedIndex]="tabIndex">
                        <nz-tab nzTitle="Contact Issues" [formGroup]="contactIssueGroup">
                            <textarea rows="4" nz-input type="text" formControlName="contactIssues"></textarea>
                        </nz-tab>
                        <nz-tab nzTitle="Roster Alerts" [formGroup]="contactIssueGroup">
                            <textarea rows="4" nz-input type="text" formControlName="rosterAlerts"></textarea>
                        </nz-tab>
                        <nz-tab nzTitle="Runsheet Alerts" [formGroup]="contactIssueGroup">
                            <textarea rows="4" nz-input type="text" formControlName="runsheetAlerts"></textarea>
                        </nz-tab>
                    </nz-tabset>
                </div>

                <div nz-row class="divider">
                    <button class="botton recordHeaderMainButtons" (click)="addCaseStaffModal =  true;POPULATE_CASE_STAFF()">Add Case Staff</button>
                
                    <div nz-row>
                        <div nz-col nzSpan="24">
                            <nz-table #basicTable [nzSize]="'small'" [nzData]="caseStaffArray">
                                <thead>
                                  <tr>
                                    <th>Name</th>
                                    <th>Program</th>
                                    <th>Contacts</th>
                                    <th style="width:2rem"></th>
                                  </tr>
                                </thead>
                                <tbody>
                                  <tr *ngFor="let data of basicTable.data">
                                    <td>{{data.name}}</td>
                                    <td>{{data.program}}</td>
                                    <td>{{data.contactDetails}}</td>
                                    <td>
                                        <a (click)="deleteStaff(data)">Delete</a>
                                    </td>
                                  </tr>
                                </tbody>
                              </nz-table>
                        </div>
                    </div>
                
                </div>

            </div>
        </ng-container>

    </div>

    <div nz-row *ngIf="!isAdmin">
        <div class="space-top">
            <div class="form-group">
                <label for="" class="info">Address Information</label>
                <div class="edit-btn">
                    <div class="right-btns">
                        <button nz-button nzType="default" nzValue="small" (click)="addAddressOpen()" class="right"><i nz-icon
                                nzType="plus" nzTheme="outline"></i> Add Address</button>
                    </div>
                </div>
                <nz-table #basicTable [nzData]="user?.addresses" [nzSize]="'small'" [nzFrontPagination]="false"
                    [nzShowPagination]="false">
                    <thead>
                        <tr>
                            <th>Description</th>
                            <th>Address</th>
                            <th>Suburb</th>
                            <th>Postcode</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let data of basicTable.data">
                            <td>{{ data.description }}</td>
                            <td>{{ data.address1 }}</td>
                            <td>{{ data.suburb }}</td>
                            <td>{{ data.postCode }}</td>
                            <td>
                                <a (click)="editAddressOpen(data)">Edit</a>
                                <nz-divider nzType="vertical"></nz-divider>
                                <a nz-popconfirm nzPopconfirmTitle="Are you sure delete this address?"
                                    nzPopconfirmPlacement="bottom" (nzOnConfirm)="confirm(1,data)"
                                    (nzOnCancel)="cancel(1)">Delete</a>
                            </td>
                        </tr>
                    </tbody>
                </nz-table>
            </div>
        
            <div class="form-group space-top">
                <label for="" class="info">Contact Information</label>
                <div class="edit-btn">
                    <div class="right-btns">
                        <button nz-button nzType="default" nzValue="small" (click)="addContactOpen()" class="right"><i nz-icon
                                nzType="plus" nzTheme="outline"></i> Add Contact</button>
                    </div>
                </div>
                <nz-table #contactTable [nzData]="user?.contacts" [nzSize]="'small'" [nzFrontPagination]="false"
                    [nzShowPagination]="false">
                    <thead>
                        <tr>
                            <th>Type</th>
                            <th>Detail</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let data of contactTable.data">
                            <td>{{ data.type }}</td>
                            <td>{{ data.detail }}</td>
                            <td>
                                <a (click)="editContactOpen(data)">Edit</a>
                                <nz-divider nzType="vertical"></nz-divider>
                                <a nz-popconfirm nzPopconfirmTitle="Are you sure delete this contact?"
                                    nzPopconfirmPlacement="bottom" (nzOnConfirm)="confirm(2, data)"
                                    (nzOnCancel)="cancel(2)">Delete</a>
                            </td>
                        </tr>
                    </tbody>
                </nz-table>
            </div>
        </div>
    </div>
</ng-container>


 <nz-modal [(nzVisible)]="profileStaffModal" [nzStyle]="{ top: '20px' }" nzTitle="Update Profile" (nzOnCancel)="handleCancel()">

    <div nz-row nzGutter="16" [formGroup]="userForm">
        <div nz-row nzGutter="24">
            <div nz-col nzSpan="8" lass="form-group">
                <div class="form-group">
                    <label for="">Record ID</label>
                    <span class="recordid-title">{{ userForm.get('uniqueID').value }}</span>
                </div>
            </div>
            <div nz-col nzSpan="16">
                <div class="form-group">
                    <label for="">Preferred Name</label>
                    <input nz-input type="text"  oninput="this.value = this.value.toUpperCase()" formControlName="preferredName">
                </div>
            </div>           
        </div>
        <div nz-row nzGutter="16">

            <div nz-col  class="form-group" nzSpan="8">
                <label for="">Lastname</label>
                <input nz-input type="text" formControlName="surnameOrg">
            </div>

            <div nz-col class="form-group" nzSpan="8">
                <label for="">Firstname</label>
                <input nz-input type="text" formControlName="firstName">
            </div>
            <div nz-col class="form-group" nzSpan="8">
                <label for="">Middlename</label>
                <input nz-input type="text" formControlName="middleNames">
            </div>

        </div>
        <div nz-row nzGutter="16">
          
                <div nz-col class="form-group" nzSpan="8">
                    <label for="">Title</label>
                    <nz-select nzAllowClear nzPlaceHolder="" formControlName="title">
                        <nz-option *ngFor="let title of titles" [nzValue]="title" [nzLabel]="title">
                        </nz-option>
                    </nz-select>
                </div>
                <div nz-col class="form-group" nzSpan="8">
                    <label for="">Gender</label>
                    <nz-select formControlName="gender" nzAllowClear nzPlaceHolder="">
                        <nz-option *ngFor="let gender of genderArr" [nzValue]="gender" [nzLabel]="gender">
                        </nz-option>
                    </nz-select>
                </div>
        
        </div>
        <div nz-row nzGutter="16">
            <div nz-col nzSpan="24" class="form-group">
                <label for="">Birthdate</label>
                <div nz-col nzSpan="6">
                    <nz-select nzAllowClear nzPlaceHolder="" formControlName="year">
                        <nz-option *ngFor="let year of years" [nzValue]="year" [nzLabel]="year">
                        </nz-option>
                    </nz-select>
                </div>
                <div nz-col nzSpan="7">
                    <nz-select nzAllowClear nzPlaceHolder="" formControlName="month">
                        <nz-option *ngFor="let month of months" [nzValue]="month" [nzLabel]="month">
                        </nz-option>
                    </nz-select>
                </div>
                <div nz-col nzSpan="4">
                    <nz-select nzAllowClear nzPlaceHolder="" formControlName="day">
                        <nz-option *ngFor="let day of days" [nzValue]="day" [nzLabel]="day">
                        </nz-option>
                    </nz-select>
                </div>
            </div>
        </div>
    </div>
    <div *nzModalFooter>
        <button nz-button nzType="default" (click)="handleCancel()">Cancel</button>
        <button nz-button nzType="primary" [nzLoading]="loading"  (click)="saveProfile()">Save</button>
    </div>

</nz-modal>

<nz-modal [(nzVisible)]="profileStaffPreferredModal" [nzStyle]="{ top: '20px' }" nzTitle="Update Profile Options"
    (nzOnCancel)="handleCancel()">

    <div nz-row nzGutter="16" [formGroup]="userForm">

        <div nz-row nzGutter="16">
            <div nz-col class="form-group" nzSpan="24">
                <label for="">Cald Status</label>
                <nz-select nzAllowClear nzPlaceHolder="" formControlName="caldStatus">
                    <nz-option *ngFor="let list of caldStatuses" [nzValue]="list" [nzLabel]="list">
                    </nz-option>
                </nz-select>
            </div>

            <div nz-col class="form-group" nzSpan="24">
                <label for="">Indigenous Status</label>
                <nz-select nzAllowClear nzPlaceHolder="" formControlName="indigStatus">
                    <nz-option *ngFor="let list of dropDowns?.indigenousArr" [nzValue]="list" [nzLabel]="list">
                    </nz-option>
                </nz-select>
            </div>
            <div nz-col class="form-group" nzSpan="24">
                <label for="">Primary Disability</label>
                <nz-select nzAllowClear nzPlaceHolder="" formControlName="primaryDisability">
                    <nz-option *ngFor="let title of dropDowns?.disabilitiesArr" [nzValue]="title" [nzLabel]="title">
                    </nz-option>
                </nz-select>
            </div>
            <div nz-col class="form-group" nzSpan="24">
                <label for="">Preferred Availability / Notes</label>
                <textarea rows="4" nz-input type="text" formControlName="note"></textarea>
            </div>
           
        </div>
        

    </div>

    <div *nzModalFooter>
        <button nz-button nzType="default" (click)="handleCancel()">Cancel</button>
        <button nz-button nzType="primary" [nzLoading]="loading" (click)="saveNotes()">Save</button>
    </div>

</nz-modal>

<nz-modal [(nzVisible)]="profileRecipientOptionsModal" [nzStyle]="{ top: '20px' }" nzTitle="Update Profile Options"
    [nzWidth]="960" (nzOnCancel)="handleCancel()">

    <div nz-row nzGutter="16" [formGroup]="userForm">

        <div nz-row nzGutter="16">
            <div nz-col class="form-group" nzSpan="8">
                <label for="">File #1</label>
                <input nz-input type="text" formControlName="file1">
            </div>

            <div nz-col class="form-group" nzSpan="8">
                <label for="">File #2</label>
                <input nz-input type="text" formControlName="file2">
            </div>
            <div nz-col class="form-group" nzSpan="8">
                <label for="">Sub Category</label>
                <input nz-input type="text" formControlName="subCategory">
            </div>
        </div>

        <div nz-row nzGutter="16">

            <div nz-col class="form-group" nzSpan="8">
                <label for="">Admitting Branch</label>
                <nz-select nzAllowClear nzPlaceHolder="" formControlName="branch">
                    <nz-option *ngFor="let title of dropDowns?.branchesArr" [nzValue]="title" [nzLabel]="title">
                    </nz-option>
                </nz-select>
            </div>

            <div nz-col class="form-group" nzSpan="8">
                <label for="">Service Region/Main Category</label>
                <nz-select nzAllowClear nzPlaceHolder="" formControlName="serviceRegion">
                    <nz-option *ngFor="let title of dropDowns?.serviceRegionArr" [nzValue]="title" [nzLabel]="title">
                    </nz-option>
                </nz-select>
            </div>

            <div nz-col class="form-group" nzSpan="8">
                <label for="">Primary Case Manager</label>
                <nz-select nzAllowClear nzPlaceHolder="" formControlName="casemanager">
                    <nz-option *ngFor="let title of dropDowns?.managerArr" [nzValue]="title" [nzLabel]="title">
                    </nz-option>
                </nz-select>
            </div>
        </div>
    </div>

    <div *nzModalFooter>
        <button nz-button nzType="default" (click)="handleCancel()">Cancel</button>
        <button nz-button nzType="primary" [nzLoading]="loading" (click)="saveProfile()">Save</button>
    </div>

</nz-modal>


<nz-modal [(nzVisible)]="profileStaffOptionsModal" [nzStyle]="{ top: '20px' }" nzTitle="Update Profile Options" [nzWidth]="960"
    (nzOnCancel)="handleCancel()">

    <div nz-row nzGutter="16" [formGroup]="userForm">
        <div nz-row nzGutter="16">
            <div nz-col class="form-group" nzSpan="8">
                <label for="">Type</label>
                <nz-select nzAllowClear nzPlaceHolder="" formControlName="type">
                    <nz-option *ngFor="let list of typesArr" [nzValue]="list" [nzLabel]="list">
                    </nz-option>
                </nz-select>
            </div>
            
            <div nz-col class="form-group" nzSpan="8">
                <label for="">Branch</label>
                <nz-select nzAllowClear nzPlaceHolder="" formControlName="stf_Department">
                    <nz-option *ngFor="let list of dropDowns?.branchesArr" [nzValue]="list" [nzLabel]="list">
                    </nz-option>
                </nz-select>
            </div>
            <div nz-col class="form-group" nzSpan="8">
                <label for="">Job Category</label>
                <nz-select nzAllowClear nzPlaceHolder="" formControlName="jobCategory">
                    <nz-option *ngFor="let title of dropDowns?.jobCategoryArr" [nzValue]="title" [nzLabel]="title">
                    </nz-option>
                </nz-select>
            </div>
        </div>
        <div nz-row nzGutter="16">

            <div nz-col class="form-group" nzSpan="8">
                <label for="">Admin Category</label>
                <nz-select nzAllowClear nzPlaceHolder="" formControlName="adminCategory">
                    <nz-option *ngFor="let title of dropDowns?.adminCategoryArr" [nzValue]="title" [nzLabel]="title">
                    </nz-option>
                </nz-select>
            </div>

            <div nz-col class="form-group" nzSpan="8">
                <label for="">Team/Area</label>
                <nz-select nzAllowClear nzPlaceHolder="" formControlName="team">
                    <nz-option *ngFor="let title of dropDowns?.teamArr" [nzValue]="title" [nzLabel]="title">
                    </nz-option>
                </nz-select>
            </div>
            <div nz-col class="form-group" nzSpan="8">
                <label for="">Coordinator/Manager</label>
                <nz-select nzAllowClear nzPlaceHolder="" formControlName="casemanager">
                    <nz-option *ngFor="let title of dropDowns?.managerArr" [nzValue]="title" [nzLabel]="title">
                    </nz-option>
                </nz-select>
            </div>
        </div>
        <div nz-row nzGutter="16">

            <div nz-col class="form-group" nzSpan="8">
                <label for="">Service Region</label>
                <nz-select nzAllowClear nzPlaceHolder="" formControlName="serviceRegion">
                    <nz-option *ngFor="let title of dropDowns?.serviceRegionArr" [nzValue]="title" [nzLabel]="title">
                    </nz-option>
                </nz-select>
            </div>

        </div>
        <div nz-row nzGutter="16">           
            <div nz-col class="form-group" nzSpan="6">
                <label for="">Grid No</label>
                <input nz-input type="text" formControlName="gridNo">
            </div>

            <div nz-col class="form-group" nzSpan="6">
                <label for="">Drivers License</label>
                <input nz-input type="text" formControlName="dLicense">
            </div>

            <div nz-col class="form-group" nzSpan="6">
                <label for="">Has Caseload</label>
                <label nz-checkbox formControlName="isCaseLoad"></label>
            </div>

            <div nz-col class="form-group" nzSpan="6">
                <label for="">Is Rosterable</label>
                <label nz-checkbox formControlName="isRosterable"></label>
            </div>
        </div>

        <div nz-row nzGutter="16">
            <div nz-col class="form-group" nzSpan="6">
                <label for="">MV Registration</label>
                <input nz-input type="text" formControlName="mvReg">
            </div>
            <div nz-col class="form-group" nzSpan="6">
                <label for="">N Registration</label>
                <input nz-input type="text" formControlName="nReg">
            </div>
            <div nz-col class="form-group" nzSpan="6">
                <label for="">Email Timesheet</label>
                <label nz-checkbox formControlName="isEmail"></label>
            </div>
            <div nz-col class="form-group" nzSpan="6">
                <label for="">Star Rating</label>
                <nz-rate formControlName="rating" [nzCount]="7"></nz-rate>
            </div>
        </div>
        <div nz-row nzGutter="16">
            <div nz-col class="form-group" nzSpan="7">
                <label for="">Exclude From Roaster Conflict Checking : </label>
            </div>
            <div nz-col class="form-group" nzSpan="1">
                <label nz-checkbox formControlName="excludeFromConflictChecking"></label>
            </div>
        </div>
    </div>

    <div *nzModalFooter>
        <button nz-button nzType="default" (click)="handleCancel()">Cancel</button>
        <button nz-button nzType="primary" [nzLoading]="loading" (click)="saveProfile()">Save</button>
    </div>

</nz-modal>



<nz-modal [(nzVisible)]="emailManagerOpen" nzTitle="Email Manager" [nzFooter]="modalFooter" (nzOnCancel)="emailManagerOpen = false">
   <div>
       <div *ngIf="emailManagerNoEmailShowNotif">
            <div nz-row nzGutter="16" [formGroup]="emailCoordinatorGroup">
                <div nz-col nzSpan="24" class="form-group">
                    <nz-form-item>
                        <nz-form-label>Subject</nz-form-label>
                        <nz-form-control nzErrorTip="Subject is required!">
                            <input nz-input type="text" formControlName="subject">
                        </nz-form-control>
                    </nz-form-item>
                </div>
                <div nz-col nzSpan="24" class="form-group">
                    <nz-form-item>
                        <nz-form-label>Body</nz-form-label>
                        <nz-form-control nzErrorTip="Body is required!">
                            <textarea rows="4" nz-input type="text" formControlName="content"></textarea>
                        </nz-form-control>
                    </nz-form-item>
                </div>
            </div>
       </div>
        <nz-tag *ngIf="!emailManagerNoEmailShowNotif" [nzColor]="'magenta'">Your manager has no valid email!</nz-tag>
   </div>
    <ng-template #modalFooter>
        <button nz-button nzType="default" (click)="emailManagerOpen = false">Cancel</button>
        <button nz-button nzType="primary" (click)="sendMail()">Send</button>
    </ng-template>
</nz-modal>

<nz-modal [(nzVisible)]="editModalOpen" [nzTitle]="window == 1 ? 'Edit Address': 'Edit Contact'"
    [nzFooter]="editModalFooter" (nzOnCancel)="handleCancel()">
    <div>

        <div nz-row nzGutter="16" *ngIf="window == 1" [formGroup]="addressForm">
            <div nz-col nzSpan="24" class="form-group">
                <label for="">Primary Address</label>
                <label nz-checkbox formControlName="primaryAddress"></label>
            </div>
            <div nz-col nzSpan="12" class="form-group">
                <label for="">Description</label>
                <nz-select formControlName="description" nzAllowClear nzPlaceHolder=""
                    [nzDropdownMatchSelectWidth]="false">
                    <nz-option *ngFor="let address of addressArray" [nzValue]="address" [nzLabel]="address">
                    </nz-option>
                </nz-select>
            </div>
            <div nz-col nzSpan="12" class="form-group">
                <label for="">Postcode & Suburb</label>
                <suburb formControlName="pcodesuburb"></suburb>
            </div>
            <div nz-col nzSpan="24" class="form-group">
                <label for="">Address</label>
                <input nz-input type="text" formControlName="address">
            </div>
        </div>

        <div *ngIf="window == 2" [formGroup]="contactForm">
            <div class="form-group">
                <label for="">Primary Phone</label>
                <label nz-checkbox formControlName="primaryPhone"></label>
            </div>
            <div class="form-group">
                <label for="">Contact Type</label>
                <nz-select formControlName="type" nzAllowClear nzPlaceHolder="" [nzDropdownMatchSelectWidth]="false">
                    <nz-option *ngFor="let contact of contactsArray" [nzValue]="contact" [nzLabel]="contact">
                    </nz-option>
                </nz-select>
            </div>
            <div class="form-group">
                <label for="">Details</label>
                <input nz-input type="text" formControlName="details">
            </div>
        </div>

    </div>

    <ng-template #editModalFooter>
        <button nz-button nzType="default" (click)="handleCancel()">Close</button>
        <button nz-button nzType="primary" (click)="edit()" [nzLoading]="loading">Save</button>
    </ng-template>
</nz-modal>


<nz-drawer [nzVisible]="editProfileDrawer" [nzMaskClosable]="false" [nzWidth]="640" (nzOnClose)="closeDrawer()"
    [nzBodyStyle]="{ height: 'calc(100% - 55px)', overflow: 'auto', 'padding-bottom': '53px' }">
    <p class="title" style=" margin-bottom: 24px;">User Profile</p>

    <div [formGroup]="userForm">
        <div class="form-row" nz-row nzGutter="16">
            <div nz-col nzSpan="4" class="form-group">
                <label for="">Title</label>
                <nz-select class="title" formControlName="title" nzAllowClear nzPlaceHolder=""
                    [nzDropdownMatchSelectWidth]="false">
                    <nz-option *ngFor="let title of titles" [nzValue]="title" [nzLabel]="title">
                    </nz-option>
                </nz-select>
            </div>
        </div>

        <div class="form-row" nz-row nzGutter="16">
            <div nz-col nzSpan="5" class="form-group">
                <label for="">Gender</label>
                <nz-select class="title" formControlName="gender" nzAllowClear nzPlaceHolder=""
                    [nzDropdownMatchSelectWidth]="false">
                    <nz-option *ngFor="let gender of genderArr" [nzValue]="gender" [nzLabel]="gender">
                    </nz-option>
                </nz-select>
            </div>
            <div nz-col nzSpan="15" class="form-group">
                <label for="">Birthdate</label>
                <div nz-row nzGutter="16">
                    <div nz-col nzSpan="9">
                        <nz-select class="title" formControlName="month" nzAllowClear nzPlaceHolder=""
                            [nzDropdownMatchSelectWidth]="false">
                            <nz-option *ngFor="let month of months" [nzValue]="month" [nzLabel]="month">
                            </nz-option>
                        </nz-select>
                    </div>
                    <div nz-col nzSpan="7">
                        <nz-select class="title" formControlName="day" nzAllowClear nzPlaceHolder=""
                            [nzDropdownMatchSelectWidth]="false">
                            <nz-option *ngFor="let day of days" [nzValue]="day" [nzLabel]="day">
                            </nz-option>
                        </nz-select>
                    </div>
                    <div nz-col nzSpan="7">
                        <nz-select class="title" formControlName="year" nzAllowClear nzPlaceHolder=""
                            [nzDropdownMatchSelectWidth]="false">
                            <nz-option *ngFor="let year of years" [nzValue]="year" [nzLabel]="year">
                            </nz-option>
                        </nz-select>
                    </div>
                </div>
            </div>
        </div>

        <div class="form-row" nz-row nzGutter="16">
            <div nz-col nzSpan="8" class="form-group">
                <label for="">Lastname</label>
                <input type="text" formControlName="surnameOrg" nz-input autocomplete="palong">
            </div>
            <div nz-col nzSpan="8" class="form-group">
                <label for="">Firstname</label>
                <input type="text" formControlName="firstName" nz-input autocomplete="palong">
            </div>
            <div nz-col nzSpan="8" class="form-group">
                <label for="">Middlename</label>
                <input type="text" formControlName="middleNames" nz-input autocomplete="palong">
            </div>
        </div>

    </div>

    <div class="footer">
        <button type="button" (click)="closeDrawer()" class="ant-btn"
            style="margin-right: 8px;"><span>Cancel</span></button>
        <button type="button" nz-button (click)="editProfile()" [nzLoading]="loading"
            class="ant-btn ant-btn-primary"><span>Save</span></button>
    </div>
</nz-drawer>

<nz-drawer [nzVisible]="addAddressDrawer" [nzMaskClosable]="false" [nzWidth]="640" (nzOnClose)="closeDrawer()"
    [nzBodyStyle]="{ height: 'calc(100% - 55px)', overflow: 'auto', 'padding-bottom': '53px' }">
    <p class="title" style=" margin-bottom: 24px;">Add Address Information</p>

    <form nz-row nzGutter="16" nz-form [nzLayout]="'vertical'" [formGroup]="addressForm">
        <div nz-col nzSpan="24">
            <nz-form-item>
                <nz-form-label>Primary Address</nz-form-label>
                <nz-form-control>
                    <label nz-checkbox formControlName="primaryAddress"></label>
                </nz-form-control>
            </nz-form-item>
        </div>
        <div nz-col nzSpan="12">
            <nz-form-item>
                <nz-form-label>Type</nz-form-label>
                <nz-form-control nzErrorTip="Type is required!">
                    <nz-select formControlName="description" nzAllowClear nzPlaceHolder=""
                        [nzDropdownMatchSelectWidth]="false">
                        <nz-option *ngFor="let address of addressArray" [nzValue]="address" [nzLabel]="address">
                        </nz-option>
                    </nz-select>
                </nz-form-control>
            </nz-form-item>
        </div>
        <div nz-col nzSpan="24">
            <nz-form-item>
                <nz-form-label>Address</nz-form-label>
                <nz-form-control nzErrorTip="Address is required!">
                    <input nz-input type="text" formControlName="address" oninput="this.value = this.value.toUpperCase()">
                </nz-form-control>
            </nz-form-item>
        </div>
        <div nz-col nzSpan="24">
            <nz-form-item>
                <nz-form-label>Suburb</nz-form-label>
                <nz-form-control nzErrorTip="Suburb is required!">
                    <suburb formControlName="pcodesuburb"></suburb>
                </nz-form-control>
            </nz-form-item>
        </div>
    </form>

    <div class="footer">
        <button type="button" (click)="closeDrawer()" class="ant-btn"
            style="margin-right: 8px;"><span>Cancel</span></button>
        <button type="button" nz-button [nzLoading]="loading" (click)="addAddress()"
            class="ant-btn ant-btn-primary"><span>Save</span></button>
    </div>
</nz-drawer>

<nz-drawer [nzVisible]="addContactDrawer" [nzMaskClosable]="false" [nzWidth]="420" (nzOnClose)="closeDrawer()"
    [nzBodyStyle]="{ height: 'calc(100% - 55px)', overflow: 'auto', 'padding-bottom': '53px' }">
    <p class="title" style=" margin-bottom: 24px;">Add Contact Information</p>

    <form nz-row nzGutter="16" nz-form [nzLayout]="'vertical'" [formGroup]="contactForm">

        <div nz-col nzSpan="24">
            <nz-form-item>
                <nz-form-label>Primary Phone</nz-form-label>
                <nz-form-control>
                    <label nz-checkbox formControlName="primaryPhone"></label>
                </nz-form-control>
            </nz-form-item>
        </div>

        <div nz-col nzSpan="12">
            <nz-form-item>
                <nz-form-label>Contact Type</nz-form-label>
                <nz-form-control nzErrorTip="Contact Type is required!">
                    <nz-select formControlName="type" nzAllowClear nzPlaceHolder=""
                        [nzDropdownMatchSelectWidth]="false">
                        <nz-option *ngFor="let contact of contactsArray" [nzValue]="contact" [nzLabel]="contact">
                        </nz-option>
                    </nz-select>
                </nz-form-control>
            </nz-form-item>
        </div>
        <div nz-col nzSpan="24">
            <nz-form-item>
                <nz-form-label>Details</nz-form-label>
                <nz-form-control nzErrorTip="Contact Details is required!">
                    <input type="text" *ngIf="!isMobile(contactForm.get('type').value) && !isPhoneFax(contactForm.get('type').value)" formControlName="details" placeholder="Details" nz-input />
                    <app-phonefax *ngIf="isMobile(contactForm.get('type').value)" [isMobile]="true" formControlName="details"></app-phonefax>
                    <app-phonefax *ngIf="isPhoneFax(contactForm.get('type').value)" formControlName="details"></app-phonefax>
                </nz-form-control>
            </nz-form-item>
        </div>
    </form>

    <div class="footer">
        <button type="button" (click)="closeDrawer()" class="ant-btn"
            style="margin-right: 8px;"><span>Cancel</span></button>
        <button type="button" nz-button (click)="addContact()" [nzLoading]="loading"
            class="ant-btn ant-btn-primary"><span>Save</span></button>
    </div>
</nz-drawer>

<nz-modal [(nzVisible)]="changeProfilePictureModal" nzTitle="Update Profile Picture" (nzOnCancel)="handleCancel()">
    <div *ngIf="changeProfilePictureModal">
        <app-image-cropper [src]="src" [role]="innerValue.view" [id]="user.uniqueID" (imgBLOB)="imgBLOB($event)"></app-image-cropper>
        <input type="file" id="file" (change)="uploadChange($event)">
        <div><label for="file" class="upload-pic">Browse Directory</label></div>
    </div>

    <div *nzModalFooter>
        <button nz-button nzType="default" (click)="handleCancel()">Cancel</button>
        <button nz-button nzType="primary" (click)="uploadPicture()" [nzLoading]="loadPhoto">Upload</button>
    </div>
</nz-modal>

<nz-modal [(nzVisible)]="addCaseStaffModal" [nzStyle]="topBelow" [nzWidth]="800" [nzTitle]="'Add Case Staff'" (nzOnCancel)="handleCancel()">
    
    <div nz-row *ngIf="addCaseStaffModal">
        <div class="flexy">        
            <nz-steps [nzSize]="'small'" [nzCurrent]="current" nzDirection="vertical">
                <nz-step class="mini" nzTitle="Coordinator" nzDescription=""></nz-step>
                <nz-step class="mini" nzTitle="Program & Notes" nzDescription=""></nz-step>
     
            </nz-steps>
            
            <nz-divider class="full-height" nzType="vertical"></nz-divider>
            
            <div class="steps-content" [formGroup]="caseStaffGroup">
                
                <div nz-row *ngIf="current == 0">
                    <nz-select style="width:100%" nzAllowClear formControlName="coordinator" nzPlaceHolder="Coordinator">
                        <nz-option *ngFor="let data of coordinator$ | async"  [nzValue]="data.uniqueId" [nzLabel]="data.name"></nz-option>
                    </nz-select>
                </div>

                <div nz-row *ngIf="current == 1">
                   <div class="form-group">
                        <nz-select style="width:100%" nzAllowClear formControlName="program" nzPlaceHolder="Program">
                            <nz-option *ngFor="let data of programs$ | async"  [nzValue]="data" [nzLabel]="data"></nz-option>
                        </nz-select>
                   </div>

                   <div class="form-group">
                        <textarea rows="4" nz-input formControlName="notes"></textarea>
                   </div>
                </div>
            </div>
        </div>
        
    </div>
    
    <div *nzModalFooter>
        <ng-container>
            <button nz-button nzType="default" (click)="pre()" *ngIf="current > 0">
                <span>Previous</span>
            </button>
            <button nz-button nzType="default" (click)="next()" *ngIf="current < 1">
                <span>Next</span>
            </button>
            <button nz-button nzType="primary" [disabled]= "!caseStaffGroup.get('program').value " *ngIf="current === 1" (click)="addCaseStaff()">
                <span>Done</span>
            </button>
        </ng-container>
    </div>
</nz-modal>
