<nz-modal [(nzVisible)]="inActiveOpen" [nzWidth]="850" [nzStyle]="{ top: '20px' }" [nzTitle]="'Auto Roster Creation - Date Selection'" (nzOnCancel)="handleCancel()" (nzOnOk)="handleOk()">
    <div nz-row nzGutter="16">
        <div nz-row class="form-group" [formGroup]="inActiveForm">
            <label for="">Time Period</label>
            <nz-range-picker formControlName="timePeriod"></nz-range-picker>
        </div>
    </div>
</nz-modal>


<nz-modal [(nzVisible)]="activeOpen" [nzWidth]="850" [nzStyle]="{ top: '20px' }" [nzTitle]="'Fee and Price Update Options'" (nzOnCancel)="handleCancel()" (nzOnOk)="handleOk()">
    <div nz-row nzGutter="16">
        <div nz-row>
            <div nz-col nzSpan="12" [formGroup]="activeForm">
                <h3>For The Master Roster</h3>
                <div class="form-group">
                    <label nz-checkbox formControlName="aUpdateActivities">Update prices for existing activities</label>
                </div>
                <div class="form-group">
                    <label nz-checkbox formControlName="aUpdateApplicable">Update/recalculate fees if applicable</label>
                </div>
                <div class="form-group">
                    <label nz-checkbox formControlName="aCreateBookings">Auto Create Master Roster Bookings</label>
                </div>
                <div class="form-group">
                    <label nz-checkbox formControlName="aDeleteActivities">Delete Existing Activities</label>
                </div>
            </div>

            <div nz-col nzSpan="12" [formGroup]="activeForm">
                <h3>For Existing Roster</h3>
                <div class="form-group">
                    <label nz-checkbox formControlName="bUpdateActivities">Update prices for existing activities</label>
                </div>
                <div class="form-group">
                    <label nz-checkbox formControlName="bUpdateApplicable">Update/recalculate fees if applicable</label>
                </div>
                <div class="form-group">
                    <label nz-checkbox formControlName="bCreateBookings">Auto Create Master Roster Bookings</label>
                </div>
                <div class="form-group">
                    <label nz-checkbox formControlName="bDeleteActivities">Delete Existing Activities</label>
                </div>
            </div>

        </div>

        <div nz-row class="form-group" [formGroup]="activeForm">
            <label for="">Time Period</label>
            <nz-range-picker formControlName="timePeriod"></nz-range-picker>
        </div>
    </div>
</nz-modal>

<nz-modal [(nzVisible)]="quotesOpen" [nzWidth]="1340" [nzStyle]="{ top: '20px' }" [nzTitle]="title" (nzOnCancel)="handleCancel()" (nzOnOk)="handleOk()">
    <div nz-row nzGutter="16">
        
        <nz-tabset [nzTabPosition]="'top'" [nzType]="'card'" [nzSelectedIndex]="tabFindIndex">
            <nz-tab nzTitle="General" [nzDisabled]="disableAddTabs" (nzClick)="tabFindChange(0)"> </nz-tab>
            <nz-tab nzTitle="Goals & Strategies" [nzDisabled]="disableAddTabs" (nzClick)="tabFindChange(1)"> </nz-tab>
            <nz-tab nzTitle="Quote" (nzClick)="tabFindChange(2)"></nz-tab>
            <nz-tab nzTitle="Supplements" [nzDisabled]="disableAddTabs" (nzClick)="tabFindChange(3)" *ngIf="IS_CDC"></nz-tab>
        </nz-tabset>
        
        <div nzGutter="16">
            <div *ngIf="tabFindIndex == 0"  [formGroup]="quoteGeneralForm">
                <div nz-row nzGutter="32" class="line">
                    <div nz-col nzSpan="12" nzOffset="6">
                        <div nz-row nzJustify class="mrg-btm">
                            <div nz-col nzSpan="10">
                                <div nz-col nzSpan="10" class="text-right pad-r-5">
                                    <label nzFor="ID">ID:</label>
                                </div>
                                <div nz-col nzSpan="14">
                                    <div class="form-group">
                                        <input nz-input formControlName="id" nzSize="small"  />
                                    </div>
                                </div>
                            </div>
                            <div nz-col nzSpan="14">
                                <div nz-col nzSpan="8" class="text-right pad-r-5">
                                    <label nzFor="ID">Plan Type:</label>
                                </div>
                                <div nz-col nzSpan="16">
                                    <div class="form-group">
                                        <nz-select  nzSize="small" formControlName="planType" nzAllowClear nzShowSearch>
                                            <nz-option *ngFor="let c of quotePlanType" [nzValue]="c" [nzLabel]="c"></nz-option>
                                        </nz-select>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div nz-row nzJustify class="mrg-btm">
                            <div nz-col nzSpan="24">
                                <div nz-col nzSpan="4" class="text-right pad-r-5">
                                    <label nzFor="Name">Name:</label>
                                </div>
                                <div nz-col nzSpan="20">
                                    <div class="form-group">
                                        <input nz-input formControlName="name" nzSize="small"  />
                                    </div>
                                </div>
                            </div>
                        </div>    
                    </div>
                </div>
                <div nz-row nzGutter="32" class="line">
                    <div nz-col nzSpan="12" nzOffset="6">
                        <div nz-row nzJustify class="mrg-btm">
                            <div nz-col nzSpan="24">
                                <div nz-col nzSpan="4" class="text-right pad-r-5">
                                    <label nzFor="Care Domain">Care Domain:</label>
                                </div>
                                <div nz-col nzSpan="20">
                                    <div class="form-group">
                                        <nz-select  nzSize="small" formControlName="careDomain" nzAllowClear nzShowSearch>
                                            <nz-option *ngFor="let c of careDomainList" [nzValue]="c" [nzLabel]="c"></nz-option>
                                        </nz-select>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div nz-row nzJustify class="mrg-btm">
                            <div nz-col nzSpan="24">
                                <div nz-col nzSpan="4" class="text-right pad-r-5">
                                    <label nzFor="Discipline">Discipline:</label>
                                </div>
                                <div nz-col nzSpan="20">
                                    <div class="form-group">
                                        <nz-select  nzSize="small" formControlName="discipline" nzAllowClear nzShowSearch>
                                            <nz-option *ngFor="let d of disciplineList" [nzValue]="d" [nzLabel]="d"></nz-option>
                                        </nz-select>
                                    </div>
                                </div>
                            </div>
                        </div> 
                        <div nz-row nzJustify class="mrg-btm">
                            <div nz-col nzSpan="24">
                                <div nz-col nzSpan="4" class="text-right pad-r-5">
                                    <label nzFor="Program">Program:</label>
                                </div>
                                <div nz-col nzSpan="20">
                                    <div class="form-group">
                                        <nz-select  nzSize="small" formControlName="program" nzAllowClear nzShowSearch>
                                            <nz-option *ngFor="let list of programList" [nzValue]="list" [nzLabel]="list"></nz-option>
                                        </nz-select>
                                    </div>
                                </div>
                            </div>
                        </div> 
                    </div>
                </div>
                <div nz-row nzGutter="32" class="line">
                    <div nz-col nzSpan="12" nzOffset="6">
                        <div nz-row nzJustify class="mrg-btm"> 
                            <div nz-col nzSpan="24">
                                <div nz-col nzSpan="4">
                                    <div class="form-group" class="text-right pad-r-5">
                                        <label>Start Date:</label>
                                    </div>
                                </div>
                                <div nz-col nzSpan="4">
                                    <div class="form-group">
                                        <nz-date-picker nzSize="small" formControlName="starDate" [nzFormat]="dateFormat"></nz-date-picker>
                                    </div>
                                </div>
                                <div nz-col nzSpan="4">
                                    <div class="form-group" class="text-right pad-r-5">
                                        <label>Sign Off Date:</label>
                                    </div>
                                </div>
                                <div nz-col nzSpan="4">
                                    <div class="form-group">
                                        <nz-date-picker nzSize="small" formControlName="signOfDate" [nzFormat]="dateFormat"></nz-date-picker>
                                    </div>
                                </div>
                                <div nz-col nzSpan="8" class="text-right">
                                    <div class="form-group">
                                        <label nz-checkbox >Publish to App</label>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div nz-row nzJustify class="mrg-btm">
                            <div nz-col nzSpan="24">
                                <div nz-col nzSpan="4" class="text-right pad-r-5">
                                    <label nzFor="Review Date">Review Date:</label>
                                </div>
                                <div nz-col nzSpan="4">
                                    <div class="form-group">
                                        <nz-date-picker nzSize="small" formControlName="reviewDate" [nzFormat]="dateFormat"></nz-date-picker>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div nz-row nzJustify class="mrg-btm"> 
                            <div nz-col nzSpan="24">
                                <div nz-col nzSpan="4" class="text-right pad-r-5">
                                    <label nzFor="Reminder Text">Reminder Text:</label>
                                </div>
                                <div nz-col nzSpan="20">
                                    <div class="form-group">
                                        <input nz-input nzSize="small" formControlName="rememberText" />
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div *ngIf="tabFindIndex == 1" >
                <div nz-row nzGutter="32">
                    <div nz-col nzSpan="12">
                        <div class="controls">
                            <div><i nz-icon nzType="plus" nzTheme="outline" (click)="showCarePlanStrategiesModal()"></i></div>
                            <div><i nz-icon nzType="printer" nzTheme="outline" (click)="handleOkTop(1)"></i></div>
                        </div>
                    </div>
                    <div nz-col nzSpan="8" nzOffset="4">
                        <div class="right">
                            <!-- <label nz-checkbox >Expand Goal Description</label> -->
                        </div>
                    </div>
                </div>
                
                <div nz-row>
                    <nz-table #headerTable [nzShowPagination]="false" [nzFrontPagination]="false" [nzLoading]="loading" [nzData]="goalsAndStratergies" nzSize="small" [nzScroll]="{ y: '340px' }">
                        <thead>
                            <tr>
                                <th style="width:10%;">Ant Complete</th>
                                <th style="width:10%;">Last Review</th>
                                <th style="width:10%">%</th>
                                <th style="width:60%;">Goal</th>
                                <th style="width:10%;">Action</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr *ngFor="let data of headerTable.data">
                                <td style="width:10%;">{{data.achievementDate | date: 'dd/MM/y' }}</td>
                                <td style="width:10%;">{{data.lastReviewed | date: 'dd/MM/y' }}</td>
                                <td style="width:10%;">{{data.achievement }}</td>
                                <td style="width:60%;">{{data.goal}}</td>
                                <td style="width:10%;">
                                    <a (click)="showEditCarePlanModal(data)">Update</a>
                                    <nz-divider nzType="vertical"></nz-divider>
                                    <a nz-popconfirm nzPopconfirmTitle="Are you sure you want to delete this from CarePlan Goal/s ?"
                                    nzPopconfirmPlacement="bottom" (nzOnConfirm)="deleteCarePlanGoal(data)">Delete</a>
                                </td>
                            </tr>
                        </tbody>
                    </nz-table>
                </div>
                
            </div>
            
            </div>
            
            <div *ngIf="tabFindIndex == 2" >

            <div nz-row nzGutter="32" [formGroup]="quoteForm">
 
                <div nz-col nzSpan="8">
                    <div class="form-group">
                        <nz-select formControlName="program" nzSize="small"  [nzDropdownMatchSelectWidth]="false" nzAllowClear nzPlaceHolder="Program">
                            <nz-option *ngFor="let list of quoteProgramList" [nzValue]="list" [nzLabel]="list"></nz-option>
                        </nz-select>
                    </div>
                </div>

                <div nz-col nzSpan="8">
                    <div class="form-group">
                        <nz-select formControlName="template" nzSize="small" [nzDropdownMatchSelectWidth]="false" nzAllowClear nzPlaceHolder="Templates">
                            <nz-option *ngFor="let list of quoteTemplateList" [nzValue]="list" [nzLabel]="list"></nz-option>
                        </nz-select>
                    </div>
                </div>

            </div>

            <div nz-row nzGutter="32" class="line" [formGroup]="quoteForm" [hidden]="quoteForm.get('program').value == null">
                <div nz-col nzSpan="6">
                    <input nz-input formControlName="no" placeholder="Quote No" [disabled]="true" nzSize="small" />
                </div>
                
                <div nz-col nzSpan="4">
                    <nz-select  class="select" formControlName="type" nzSize="small" nzAllowClear nzPlaceHolder="Type">
                        <nz-option *ngFor="let list of typeList" [nzValue]="list" [nzLabel]="list"></nz-option>
                    </nz-select>
                </div>
                <div nz-col nzSpan="6" [formGroup]="quoteForm" [hidden]="quoteForm.get('program').value == null">
                    <label nz-checkbox formControlName="charges" (change)="checkValue($event)"><span class="accept-admin">Accept fee and Admin Charges</span></label>
                </div>
                <div nz-col nzSpan="8" >
                    <div class="right">
                        <nz-range-picker nzSize="small" formControlName="period"></nz-range-picker>

                        <nz-select class="select" formControlName="basePeriod" nzSize="small" nzAllowClear nzPlaceHolder="Base Period">
                            <nz-option *ngFor="let l of basePeriodArr" [nzValue]="l" [nzLabel]="l"></nz-option>
                        </nz-select>
                    </div>
                </div>
            </div>

            <div nz-row class="line" *ngIf="quoteForm.get('program').value">
                <div nz-col nzSpan="12">
                    <div class="controls">
                        <div><i nz-icon nzType="plus" nzTheme="outline" (click)="quoteLineModal()"></i></div>
                        <div><i nz-icon nzType="edit" nzTheme="outline"></i></div>
                        <div><i nz-icon nzType="close" nzTheme="outline"></i></div>
                        <div><i nz-icon nzType="printer" nzTheme="outline" (click)="printQuoteLines()"></i></div>
                    </div>
                </div>
            </div>

            <div nz-row *ngIf="quoteForm.get('program').value">
                <nz-table #basicTable [nzData]="quoteLines" nzSize="small">
                    <thead>
                      <tr>
                        <th>Item Code</th>
                        <th>Description</th>
                        <th>Qty</th>
                        <th>Bill Unit</th>
                        <th>Frequency</th>
                        <th>Total Qty</th>
                        <th>Price</th>
                        <th>Amount</th>
                        <th>GST</th>
                        <th>Total</th>
                        <th></th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr *ngFor="let data of basicTable.data;let i = index">
                        <td>{{data.code}}</td>
                        <td>{{data.displayText}}</td>
                        <td>{{data.quantity}}</td>

                        <td>{{data.billUnit}}</td>
                        <td>{{data.frequency}}</td>
                        <td>{{data.quoteQty}}</td>
                        <td>${{data.price}}</td>
                        <td>$ {{amount(data.price,data.quoteQty)}}  </td>                        
                        <td>{{data.tax}}</td>
                        <td>${{totalamount(data.price,data.quoteQty,data.tax,data.quantity)}}</td>
                        <td>
                            <a (click)="showEditQuoteModal(data, i)">Update</a>
                            <nz-divider nzType="vertical"></nz-divider>
                            <a nz-popconfirm nzPopconfirmTitle="Are you sure you want to delete this from the Quote List ?"
                            nzPopconfirmPlacement="bottom" (nzOnConfirm)="deleteQuoteList(data, i)">Delete</a>
                        </td>
                      </tr>
                    </tbody>
                  </nz-table>
            </div>

            <div nz-row class="line" nzGutter="16" *ngIf="quoteForm.get('program').value">
                <div nz-col nzSpan="17">
                    <div nz-row nzGutter="16"> 
                        <div nz-col nzSpan="10" class="inline" *ngIf="!IS_CDC" [formGroup]="quoteForm">
                            <span class="title">Initial Budget</span>
                            <input nz-input class="mini" placeholder="" nzSize="small" formControlName="initialBudget" />
                        </div>
                        <div nz-col nzSpan="10" class="inline"  *ngIf="IS_CDC" [formGroup]="quoteForm"> 
                            <span class="title">Gov't Contribution</span>
                            <input nz-input class="mini" placeholder="" nzSize="small" formControlName="govtContrib" />
                        </div>
                        <div nz-col nzSpan="14" class="inline"  *ngIf="IS_CDC">
                            <span class="title">Centrelink Income Tested Fee</span>
                            <span>
                                <nz-select [(ngModel)]="value" nzSize="small" nzAllowClear nzPlaceHolder="Choose">
                                    <nz-option nzValue="jack" nzLabel="Jack"></nz-option>
                                    <nz-option nzValue="lucy" nzLabel="Lucy"></nz-option>
                                    <nz-option nzValue="disabled" nzLabel="Disabled" nzDisabled></nz-option>
                                </nz-select>
                            </span>
                            <span>@</span>
                            <span><input nz-input class="mini" placeholder="" nzSize="small" [(ngModel)]="value" /></span>
                            <span>=</span>
                            <span><input nz-input class="mini" placeholder="" nzSize="small" [(ngModel)]="value" /></span>
                        </div>
                    </div>
                    <div nz-row class="line" *ngIf="IS_CDC">
                        <div class="div-table">
                            <div>
                                <div></div>
                                <div>Annual Charge</div>
                                <div>Daily</div>
                                <div>Monthly</div>
                            </div>
                            <div>
                                <div>Agreed Basic Care Fee</div>
                                <div> <input nz-input  nzSize="small" [(ngModel)]="value" /></div>
                                <div> <input nz-input  nzSize="small" [(ngModel)]="value" /></div>
                                <div> <input nz-input  nzSize="small" [(ngModel)]="value" /></div>
                            </div>
                            <div>
                                <div>Agreed Income Tested Fee</div>
                                <div> <input nz-input  nzSize="small" [(ngModel)]="value" /></div>
                                <div> <input nz-input  nzSize="small" [(ngModel)]="value" /></div>
                                <div> <input nz-input nzSize="small" [(ngModel)]="value" /></div>
                            </div>
                            <div>
                                <div></div>
                                <div> <input nz-input nzSize="small" [(ngModel)]="value" /></div>
                                <div> <input nz-input  nzSize="small" [(ngModel)]="value" /></div>
                                <div> <input nz-input  nzSize="small" [(ngModel)]="value" /></div>
                            </div>
                            <div>
                                <div>ADD Pro Rata Prev Balance</div>
                                <div> <input nz-input nzSize="small" [(ngModel)]="value" /></div>
                                <div> </div>
                                <div> </div>
                            </div>
                            <div>
                                <div>Total Package Value</div>
                                <div> <input nz-input  nzSize="small" [ngModel]="quoteForm.get('govtContrib').value" /></div>
                                <div> </div>
                                <div> </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div nz-col nzSpan="7">
                    <div>
                        <div class="div-table">
                            <div>
                                <div>Base Quote</div>
                                <div> 
                                    <span nz-input nzSize="small"> $ {{ total_base_quote| number : '1.2-2' }} </span>                                    
                                </div>
                            </div>
                            <div>
                                <div>Admin & Case Management</div>
                                <div> <span nz-input nzSize="small"> $ {{ total_admin  | number : '1.2-2'}}</span></div>
                            </div>
                            <div>
                                <div>Total Quote</div>
                                <div> <span nz-input nzSize="small"> $ {{ total_quote  | number : '1.2-2'}} </span></div>
                            </div>
                            <div>
                                <div style="padding-top:3rem">Remaining Funds</div>
                                <div> <span nz-input nzSize="small" class="accept-admin" [ngClass]="{'negative': remaining_fund < 0, 'positive' : remaining_fund > 0 }"> $ {{( remaining_fund | number : '1.2-2' )}} </span></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div nz-row class="line" *ngIf="quoteForm.get('program').value">
                <textarea rows="4" nz-input [(ngModel)]="value" placeholder="Extra Information"></textarea>
            </div>
           </div>
                <div *ngIf="tabFindIndex == 3"  [formGroup]="supplements">
                    <div nz-row nzJustify class="mrg-btm">
                        <div nz-col nzSpan="12" nzOffset="4">
                             <nz-card>
                                <div nz-col nzSpan="16" class="text-right pad-r-5">
                                    Dementia/Cognition/Veterans Supplement <label nz-checkbox formControlName="domentica" (change)="domenticaChange($event)"></label>
                                </div>
                                <div nz-col nzSpan="6" class="text-center">
                                    <nz-radio-group formControlName="levelSupplement">
                                        <label nz-radio nzValue="LEVEL 1" [nzDisabled]="!this.supplements.get('domentica').value">LEVEL 1</label>
                                        <label nz-radio nzValue="LEVEL 2" [nzDisabled]="!this.supplements.get('domentica').value">LEVEL 2</label>
                                        <label nz-radio nzValue="LEVEL 3" [nzDisabled]="!this.supplements.get('domentica').value">LEVEL 3</label>
                                        <label nz-radio nzValue="LEVEL 4" [nzDisabled]="!this.supplements.get('domentica').value">LEVEL 4</label>
                                    </nz-radio-group>
                                </div>
                             </nz-card>
                        </div>
                    </div>
                    <div nz-row nzJustify class="mrg-btm">
                        <div nz-col nzSpan="12" nzOffset="4">
                            <nz-card>
                                <div nz-col nzSpan="16" class="text-right pad-r-5">
                                 Oxygen Supplement <label nz-checkbox formControlName="oxygen"></label>
                                </div>
                            </nz-card>
                        </div>
                    </div>
                    <div nz-row nzJustify class="mrg-btm">
                        <div nz-col nzSpan="12" nzOffset="4">
                            <nz-card>
                                <div nz-col nzSpan="16" class="text-right pad-r-5">
                                Enteral Feeding Supplement <label nz-checkbox formControlName="feedingSuplement"></label>
                                </div>
                                <div nz-col nzSpan="6" class="text-center">
                                <nz-radio-group formControlName="feedingSupplement">
                                    <label nz-radio nzValue="Bolus"     [nzDisabled]="!this.supplements.get('feedingSuplement').value">Bolus</label>
                                    <label nz-radio nzValue="Non-Bolus" [nzDisabled]="!this.supplements.get('feedingSuplement').value" style="padding-left:2.1rem;">Non-Bolus</label>
                                </nz-radio-group>
                                </div>
                            </nz-card>
                        </div>
                    </div>
                    <div nz-row nzJustify class="mrg-btm">
                        <div nz-col nzSpan="12" nzOffset="4">
                            <nz-card>
                                <div nz-col nzSpan="16" class="text-right pad-r-5">
                                 EACHD Top Up Suplemment <label nz-checkbox formControlName="EACHD"></label>
                                </div>
                            </nz-card>
                        </div>
                    </div>
                    <div nz-row nzJustify class="mrg-btm">
                        <div nz-col nzSpan="12" nzOffset="4">
                            <nz-card>
                                <div nz-col nzSpan="16" class="text-right pad-r-5">
                                Home Care Viability Supplement <label nz-checkbox formControlName="viabilitySuplement"></label>
                                </div>
                                <div nz-col nzSpan="6" class="text-center">
                                    <nz-radio-group formControlName="viabilitySupplement">
                                        <label nz-radio nzValue="MMM 1" [nzDisabled]="!this.supplements.get('viabilitySuplement').value">MMM 1</label>
                                        <label nz-radio nzValue="MMM 2" [nzDisabled]="!this.supplements.get('viabilitySuplement').value">MMM 2</label>
                                        <label nz-radio nzValue="MMM 3" [nzDisabled]="!this.supplements.get('viabilitySuplement').value">MMM 3</label>
                                        <label nz-radio nzValue="MMM 4" [nzDisabled]="!this.supplements.get('viabilitySuplement').value">MMM 4</label>
                                        <label nz-radio nzValue="MMM 5" [nzDisabled]="!this.supplements.get('viabilitySuplement').value">MMM 5</label>
                                        <label nz-radio nzValue="MMM 6" [nzDisabled]="!this.supplements.get('viabilitySuplement').value">MMM 6</label>
                                        <label nz-radio nzValue="MMM 7" [nzDisabled]="!this.supplements.get('viabilitySuplement').value">MMM 7</label>
                                    </nz-radio-group>
                                </div>
                            </nz-card>
                        </div>
                    </div>
                    <div nz-row nzJustify class="mrg-btm">
                        <div nz-col nzSpan="12" nzOffset="4">
                            <nz-card>
                                <div nz-col nzSpan="16" class="text-right pad-r-5">
                                    Financial Hardship Supplement 
                                </div>
                                <div nz-col nzSpan="4" class="text-right pad-r-5">
                                    <div> <input nz-input  nzSize="small" formControlName="financialSup" /></div>
                                </div>
                                <div nz-col nzSpan="4" class="text-right pad-r-5">
                                    <label>Per Day</label>
                                </div>
                            </nz-card>
                        </div>
                    </div>      
                </div>
    </div>

    
    <div *nzModalFooter>
        <button nz-button nzType="default" (click)="handleCancel()">Cancel</button>
        <button nz-button nzType="primary" (click)="saveQuote()" [nzLoading]="loadingSaveQuote">Save</button>
    </div>
    
</nz-modal>
        
  

  <nz-modal [(nzVisible)]="quoteLineOpen" [nzWidth]="1120" [nzStyle]="{ top: '25px' }" nzTitle="Add New Quote Line" (nzOnCancel)="handleCancelLine()" >
    <div nz-row>
        <div nz-row [formGroup]="quoteListForm"> 
            <span style="margin-right:2rem;font-weight:bold">Charge Type</span>
            <nz-radio-group formControlName="chargeType">
                <label nz-radio nzValue="1">Service</label>
                <label nz-radio nzValue="2">Item</label>
                <label nz-radio nzValue="3">Admin Charge</label>
                <label nz-radio nzValue="4">Package/Case Management</label>
            </nz-radio-group>
        </div>

        <div nz-row class="line" nzGutter="12">
            <div nz-col nzSpan="6" [formGroup]="quoteListForm" *ngIf="quoteListForm.get('chargeType').value">
                <div class="form-group">
                    <label for="">Activity Code</label>
                    <nz-select formControlName="code" nzSize="small" nzAllowClear nzPlaceHolder="Code">
                        <nz-option *ngFor="let d of codes" [nzValue]="d" [nzLabel]="d"></nz-option>
                    </nz-select>
                </div>
            </div>

            <div nz-col nzSpan="12" [formGroup]="quoteListForm" *ngIf="quoteListForm.get('chargeType').value">
                <div class="form-group">
                    <label for="">Display Text</label>
                    <input nz-input formControlName="displayText" placeholder="Display Text" nzSize="small"  />
                </div>
            </div>

            <div nz-col nzSpan="6" [formGroup]="quoteListForm" *ngIf="quoteListForm.get('chargeType').value">
                <div class="right">
                    <label for="">Sequence #</label>
                    <input nz-input placeholder="Sequence Number" nzSize="small" formControlName="sequenceNo" />
                </div>
            </div>
        </div>

        <div nz-row>
            <div nz-col nzSpan="6" [formGroup]="quoteListForm" *ngIf="quoteListForm.get('chargeType').value">
                <div class="form-group">
                    <label for="">Strategy</label>
                    <nz-select formControlName="strategy" nzSize="small" nzAllowClear nzPlaceHolder="Strategy">
                        <nz-option *ngFor="let d of strategies" [nzValue]="d.recordNumber" [nzLabel]="d.strategy"></nz-option>
                    </nz-select>
                </div>
            </div>
        </div>

        <div nz-row class="line" *ngIf="quoteListForm.get('code').value">
            <div nz-row [formGroup]="quoteListForm">
                <nz-radio-group formControlName="roster">
                    <label nz-radio nzValue="WEEKLY">Weekly</label>
                    <label nz-radio nzValue="FORTNIGHTLY">Fortnightly</label>
                    <label nz-radio nzValue="MONTHLY">Monthly</label>
                    <label nz-radio nzValue="NONE">None</label>
                </nz-radio-group>
            </div>

            <div nz-row>
                
                <div nz-col nzSpan="15">
                    <app-interval-quote [(ngModel)]="slots" (ngModelChange)="slotsChange($event)" [interval]="weekly" [mode]="'Booking'" [size]="'small'"></app-interval-quote>
                    <!-- {{ slots | json }} -->
                </div>

                <div nz-col nzSpan="9">
                    <div nz-row class="calc-wrapper" [hidden]="!weekly" >
                        <div class="spacing flex" [formGroup]="quoteListForm"> 
                            <!-- <input class="three-five" formControlName="quantity" nz-input nzSize="small" /> -->
                            <nz-input-number formControlName="quantity" [nzMin]="1" [nzStep]="1" [nzSize]="size"></nz-input-number>
                            <nz-select nzSize="small" nzAllowClear [nzDropdownMatchSelectWidth]="false" placeholder="Bill Unit" formControlName="billUnit">
                                <nz-option *ngFor="let l of billUnitArr" [nzValue]="l" [nzLabel]="l"></nz-option>
                            </nz-select>
                            <nz-select  nzSize="small" style="width:12rem" nzAllowClear [nzDropdownMatchSelectWidth]="false" placeholder="Period" formControlName="period">
                                <nz-option *ngFor="let l of periodArr" [nzValue]="l" [nzLabel]="l"></nz-option>
                            </nz-select>
                            <span>X</span>
                            <nz-input-number  [nzStep]="0" [nzSize]="size" formControlName="weekNo"></nz-input-number>
                        </div>
                        <div class="flex" [formGroup]="quoteListForm">
                            <span>Price</span>
                            <input class="three-five" formControlName="price" nz-input nzSize="small" />
                            <span>Min</span>
                            <span><label nz-checkbox formControlName="min">GST</label></span>
                            <input class="three-five" nz-input nzSize="small" formControlName="gst" />
                        </div>
                        <div nz-row class="spacing" [formGroup]="quoteListForm">
                            <nz-input-number [nzMin]="1" [nzStep]="1" [nzSize]="size" formControlName="quoteValue"></nz-input-number>
                            <span>% of Quote Value</span>
                        </div>
                        <div nz-row class="spacing" [formGroup]="quoteListForm">
                            <nz-input-number [nzMin]="1" [nzStep]="1" [nzSize]="size" formControlName="quoteBudget"></nz-input-number>
                            <span>% of Quote Budget</span>
                        </div>
                        <!-- <div nz-row class="spacing">                           
                            <span>{{dailyliving()}}</span>                           
                        </div> -->
                    </div>
                </div>

                <div nz-col nzSpan="24" class="line">                    
                    <div class="form-group" [formGroup]="quoteListForm">
                        <textarea rows="4" nz-input formControlName="notes" placeholder="Notes"></textarea>
                    </div>

                </div>
            </div>
            
        </div>
    </div>

    <div *nzModalFooter>
        <button nz-button nzType="default"><strong>Current Quote Value ${{ current_quote_value | number:'2.0' }} </strong> </button>
        <button nz-button nzType="default" ><strong> Remaining Funds ${{remainingfund()}} </strong> </button>
        <button nz-button nzType="default" (click)="handleCancelLine()">Cancel</button>
        <button nz-button nzType="primary" (click)="GENERATE_QUOTE_LINE()">Save</button>
        
    </div>

  </nz-modal>



  <nz-modal [nzWidth]="1050"  [(nzVisible)]="goalAndStrategiesmodal" nzTitle="Add/Change Recipient Goals" (nzOnCancel)="handlegoalsStarCancel()">
    <form nz-form [formGroup]="goalsAndStratergiesForm" >
        <div nz-row nzGutter="24">
            <div *ngIf="!isUpdateGoal" class="staff-wrapper" style="height: 20rem; width: 100%; overflow: auto; padding: .5rem 1rem; border: 1px solid #e9e9e9; border-radius: 3px;">
                <div nz-row nzJustify class="mrg-btm">
                    <div nz-col nzSpan="24">
                        <div class="form-group">    
                            <label nzFor="Care Domain">Select Care Plan Goal:</label>
                            <nz-select  nzSize="small" formControlName="goal" nzAllowClear nzShowSearch>
                                <nz-option *ngFor="let c of goalOfCarelist" [nzValue]="c" [nzLabel]="c"></nz-option>
                            </nz-select>
                        </div>
                    </div>
                </div>
            </div>
            <div *ngIf="isUpdateGoal">
                <div nz-row nzSpan="24" class="mrg-btm">
                    <nz-tabset [nzTabPosition]="'top'" [nzType]="'card'" [nzSelectedIndex]="tabFinderIndexbtn">
                        <nz-tab nzTitle="Detail/s" (nzClick)="tabFindChangeStrategies(0)"> </nz-tab>
                        <nz-tab nzTitle="Strategies" (nzClick)="tabFindChangeStrategies(1)"> </nz-tab>
                    </nz-tabset>
                    <div>
                        <div *ngIf="tabFinderIndexbtn == 0"  [formGroup]="goalsAndStratergiesForm">
                            <div nz-row nzJustify>
                                <div nz-col nzSpan="22" nzOffset="2">
                                    <div nz-row nzJustify>
                                        <div nz-col nzSpan="24">
                                            <div nz-col nzSpan="2" class="text-right pad-r-5">
                                                <label nzFor=""></label>
                                            </div>
                                            <div nz-col nzSpan="15">
                                                <div class="form-group" style="margin-bottom:7px;">
                                                    <input nz-input formControlName="title" nzSize="small"  />
                                                </div>
                                            </div>
                                        </div>
                                    </div> 
                                    <div nz-row nzJustify>
                                        <div nz-col nzSpan="24">
                                            <div nz-col nzSpan="2" class="text-right pad-r-5">
                                                <label nzFor="">Goal : </label>
                                            </div>
                                            <div nz-col nzSpan="15">
                                                <div class="form-group" style="margin-bottom:7px;">
                                                    <textarea rows="4" nz-input  formControlName="goal"></textarea>
                                                </div>
                                            </div>
                                        </div>
                                    </div>   
                                    <div nz-row nzJustify>
                                        <div nz-col nzSpan="24">
                                            <div nz-col nzSpan="2" class="text-right">
                                                <label nzFor=""></label>
                                            </div>
                                            <div nz-col nzSpan="5" class="text-right pad-r-5">
                                                <label nzFor="">Anticipated Achivement Date : </label>
                                            </div>
                                            <div nz-col nzSpan="10">
                                                <div class="form-group" style="margin-bottom:7px;">
                                                    <nz-date-picker nzSize="achievementDate" formControlName="achievementDate" nzSize="small" [nzFormat]="dateFormat"></nz-date-picker>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div nz-row nzJustify>
                                        <div nz-col nzSpan="24">
                                            <div nz-col nzSpan="2" class="text-right">
                                                <label nzFor=""></label>
                                            </div>
                                            <div nz-col nzSpan="5" class="text-right pad-r-5">
                                                <label nzFor="">Last Reviewd : </label>
                                            </div>
                                            <div nz-col nzSpan="10">
                                                <div class="form-group" style="margin-bottom:7px;">
                                                    <nz-date-picker nzSize="small" formControlName="lastReviewed" [nzFormat]="dateFormat"></nz-date-picker>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div nz-row nzJustify>
                                        <div nz-col nzSpan="24">
                                            <div nz-col nzSpan="2" class="text-right">
                                                <label nzFor=""></label>
                                            </div>
                                            <div nz-col nzSpan="5" class="text-right pad-r-5">
                                                <label nzFor="">Date Achived : </label>
                                            </div>
                                            <div nz-col nzSpan="6">
                                                <div class="form-group" style="margin-bottom:7px;">
                                                    <nz-date-picker nzSize="small" formControlName="dateAchieved" [nzFormat]="dateFormat"></nz-date-picker>
                                                </div>
                                            </div>
                                            <div nz-col nzSpan="3" class="text-right pad-r-5">
                                                <label nzFor="">% Achived : </label>
                                            </div>
                                            <div nz-col nzSpan="1">
                                                <div class="form-group" style="margin-bottom:7px;">
                                                    <input nz-input formControlName="achievement" nzSize="small"  />
                                                </div>
                                            </div>
                                        </div>
                                    </div> 
                                    <div nz-row nzJustify>
                                        <div nz-col nzSpan="24">
                                            <div nz-col nzSpan="2" class="text-right">
                                                <label nzFor=""></label>
                                            </div>
                                            <div nz-col nzSpan="5" class="text-right pad-r-5">
                                                <label nzFor="">Achivement Index : </label>
                                            </div>
                                            <div nz-col nzSpan="10">
                                                <div class="form-group" style="margin-bottom:7px;">
                                                    <nz-select formControlName="achievementIndex" nzSize="small" nzAllowClear nzPlaceHolder="Code">
                                                        <nz-option *ngFor="let d of plangoalachivementlis" [nzValue]="d" [nzLabel]="d"></nz-option>
                                                    </nz-select>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div nz-row nzJustify>
                                        <div nz-col nzSpan="24">
                                            <div nz-col nzSpan="2" class="text-right pad-r-5">
                                                <label nzFor="">Notes : </label>
                                            </div>
                                            <div nz-col nzSpan="15">
                                                <div class="form-group" style="margin-bottom:7px;">
                                                    <textarea rows="4" nz-input  formControlName="notes"></textarea>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                </div>
                            </div>
                        </div>
                        <div *ngIf="tabFinderIndexbtn == 1"  [formGroup]="goalsAndStratergiesForm">
                            <div nz-row nzGutter="32">
                                <div nz-col nzSpan="12">
                                    <div class="controls">
                                        <div><i nz-icon nzType="plus" nzTheme="outline" (click)="showStrategiesModal()"></i></div>
                                        <div><i nz-icon nzType="printer" nzTheme="outline" (click)="handleOkTop(2)"></i></div>
                                    </div>
                                </div>
                                <div nz-col nzSpan="8" nzOffset="4">
                                    <div class="right">
                                        <!-- <label nz-checkbox >Expand Stretegy Details</label> -->
                                    </div>
                                </div>
                            </div>
                            <div nz-row>
                                <nz-table #headerTable [nzShowPagination]="false" [nzFrontPagination]="false" [nzLoading]="loading" [nzData]="stratergiesList" nzSize="small" [nzScroll]="{ y: '340px' }">
                                    <thead>
                                        <tr>
                                            <th style="width:50%;">Strategy</th>
                                            <th style="width:20%;">Achived</th>
                                            <th style="width:10%">Contracted ID</th>
                                            <th style="width:10%;">DS Services</th>
                                            <th style="width:10%;">Action</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr *ngFor="let data of headerTable.data">
                                            <td style="width:50%;">{{data.strategy}}</td>
                                            <td style="width:20%;">{{data.achieved}}</td>
                                            <td style="width:10%;">{{data.contractedId}}</td>
                                            <td style="width:10%;">{{data.DsServices}}</td>
                                            <td style="width:10%;">
                                                <a (click)="showEditStrategyModal(data)">Update</a>
                                                <nz-divider nzType="vertical"></nz-divider>
                                                <a nz-popconfirm nzPopconfirmTitle="Are you sure you want to delete this from Strategy List ?"
                                                nzPopconfirmPlacement="bottom" (nzOnConfirm)="deleteCarePlanStrategy(data)">Delete</a>
                                            </td>
                                        </tr>
                                    </tbody>
                                </nz-table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </form>

    <div *nzModalFooter>
        <ng-container>
            <button nz-button nzType="primary" [nzLoading]="postLoading" (click)="saveCarePlan()">
                <span>Save</span>
            </button>
        </ng-container>
    </div>

</nz-modal>

<nz-modal [nzWidth]="1050"  [(nzVisible)]="strategiesmodal" nzTitle="Add/Change Plan Goal Stretegy" (nzOnCancel)="handleStarCancel()">
    <form nz-form [formGroup]="stratergiesForm" >
        <div nz-row nzGutter="24">
            <div nz-row nzJustify>
                <div nz-col nzSpan="24">
                    <div nz-row nzJustify>
                        <div nz-col nzSpan="24">
                            <div nz-col nzSpan="4" class="text-right pad-r-5">
                                <label nzFor="">Strategy Detail : <br> Max 4000 characters</label>
                            </div>
                            <div nz-col nzSpan="20">
                                <div class="form-group" style="margin-bottom:7px;">
                                    <div class="form-group" style="margin-bottom:7px;">
                                        <textarea rows="4" nz-input  formControlName="detail"></textarea>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div> 
                    <div nz-row nzJustify>
                        <div nz-col nzSpan="24">
                            <div nz-col nzSpan="8" class="text-right pad-r-5">
                                <label nzFor="">Expected Outcome : </label>
                            </div>
                            <div nz-col nzSpan="6" class="pad-r-5">
                                <div class="form-group" style="margin-bottom:7px;">
                                    <nz-select formControlName="outcome" nzSize="small" nzAllowClear nzPlaceHolder="Code">
                                        <nz-option *ngFor="let d of expecteOutcome" [nzValue]="d" [nzLabel]="d"></nz-option>
                                    </nz-select>
                                </div>
                            </div>
                            <div nz-col nzSpan="4">
                                Contracted Strategy ID : 
                            </div>
                            <div nz-col nzSpan="6">
                                <input nz-input formControlName="strategyId" nzSize="small"  />
                            </div>
                        </div>
                    </div>  
                    <!-- <div nz-row nzJustify>
                        <div nz-col nzSpan="24">
                            <div nz-col nzSpan="4" class="text-right pad-r-5">
                                <label nzFor="">Service Types : </label>
                            </div>
                            <div nz-col nzSpan="20">
                                <div class="form-group" style="margin-bottom:7px;">
                                    <div class="form-group" style="margin-bottom:7px;">
                                        <textarea style="resize: none;" rows="12" nz-input  formControlName="serviceTypes"></textarea>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>   -->
                </div>
            </div>    
        </div>
    </form>
    <div *nzModalFooter>
        <ng-container>
            <button nz-button nzType="primary" [nzLoading]="postLoading" (click)="saveStrategy()">
                <span>Save</span>
            </button>
        </ng-container>
    </div>
</nz-modal>        

<!-- <app-print-pdf [reportData]="reportDataParent"></app-print-pdf> -->

<nz-drawer [nzWidth]="1000" [nzClosable]="true" [nzVisible]="drawerVisible" nzPlacement="right" [nzTitle]="pdfTitle" (nzOnClose)="handleCancelTop()">
    <div class="col-md-12 spinner" *ngIf="loading">
        <nz-spin nzSimple [nzSize]="'large'"></nz-spin>
    </div>
    <div nz-row>
        <iframe *ngIf="tryDoctype" [src]="tryDoctype" width="950" height="600"></iframe> 
    </div>
</nz-drawer>

