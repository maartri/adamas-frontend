<div nz-row>
  <div style="padding:8px">
    <div nz-row *ngIf="userview?.staff >= 951">
      <div nz-col nzSpan="2">
        <button class="botton success" (click)="newStaffModal = !newStaffModal" ><i nz-icon nzType="plus" nzTheme="outline"></i> New Staff</button>
      </div>
    </div>
    <ng-container *ngIf="userview?.staff >= 951">
      <div nz-col nzSpan="6" style="margin-top: 10px;">
        <app-search-list [reload]="reloadVal" [view]="1" [(ngModel)]="sample" (ngModelChange)="listChange($event)"></app-search-list>
      </div>
      
      <div nz-col nzSpan="8" *ngIf="user">
        <ul>
          <li class="terminate" (click)="changeStaffModalOpen()"><div><i nz-icon nzType="edit" nzTheme="outline"></i></div>Change Staff Code</li>
          <li class="terminate" nz-popconfirm nzPopconfirmTitle="Are you sure you want to delete this Staff ?"
          nzPopconfirmPlacement="bottom" (nzOnConfirm)="delete()"><div><i nz-icon nzType="delete" nzTheme="outline"></i></div>Delete Staff</li>
          <li class="terminate" (click)="terminateModalOpen()"><div><i nz-icon nzType="close" nzTheme="outline"></i></div>Terminate</li>
          <li class="leave" (click)="putonLeaveModal = !putonLeaveModal"><div><i nz-icon nzType="eye-invisible" nzTheme="outline"></i></div>Put On Leave</li>
        </ul>
      </div>
      <div nz-col nzSpan="10" *ngIf="user">
        <ul>
          <li class="terminate" (click)="printSummaryModalOpen()"><div><i nz-icon nzType="printer" nzTheme="outline"></i></div>Print</li>
          <li class="terminate" (click)="currentMonthRoster()"><div><i nz-icon nzType="calendar" nzTheme="outline"></i></div>{{longMonth}} Roster</li>
          <li class="leave" (click)="rosterMaster()"><div><i nz-icon nzType="calendar" nzTheme="outline"></i></div>Master</li>
        </ul>
      </div>
      <div nz-col nzSpan="24" *ngIf="userview">
        <nz-tabset *ngIf="user && userview" [nzTabPosition]="'top'" [nzSelectedIndex]="nzSelectedIndex" [nzType]="'card'">
          <nz-tab nzTitle="Personal" (nzClick)="view(0)"> </nz-tab>
          <nz-tab [nzDisabled]="userview.staffRecordView[1] != '1'"  nzTitle="Contacts" (nzClick)="view(1)"> </nz-tab>
          <nz-tab [nzDisabled]="userview.staffRecordView[2] != '1'"  nzTitle="Pay" (nzClick)="view(2)"></nz-tab>
          <nz-tab [nzDisabled]="userview.staffRecordView[4] != '1'"  nzTitle="Leave App" (nzClick)="view(3)"> </nz-tab>
          <nz-tab [nzDisabled]="userview.staffRecordView[5] != '1'"  nzTitle="Reminders" (nzClick)="view(4)"> </nz-tab>
          <nz-tab [nzDisabled]="userview.staffRecordView[6] != '1'"  nzTitle="OP Notes" (nzClick)="view(5)"> </nz-tab>
          <nz-tab [nzDisabled]="userview.staffRecordView[7] != '1'"  nzTitle="HR Notes" (nzClick)="view(6)"> </nz-tab>
          <nz-tab [nzDisabled]="userview.staffRecordView[8] != '1'"  nzTitle="Competencies" (nzClick)="view(7)"> </nz-tab>
          <nz-tab [nzDisabled]="userview.staffRecordView[9] != '1'"  nzTitle="Training" (nzClick)="view(8)"> </nz-tab>
          <nz-tab [nzDisabled]="userview.staffRecordView[10] != '1'" nzTitle="Incident" (nzClick)="view(9)"> </nz-tab>
          <nz-tab [nzDisabled]="userview.staffRecordView[12] != '1'" nzTitle="Document" (nzClick)="view(10)"> </nz-tab>
          <nz-tab [nzDisabled]="userview.staffRecordView[14] != '1'" nzTitle="Time & Attendance" (nzClick)="view(11)"> </nz-tab>
          <nz-tab [nzDisabled]="userview.staffRecordView[18] != '1'" nzTitle="Position" (nzClick)="view(12)"> </nz-tab>
          <nz-tab [nzDisabled]="userview.staffRecordView[19] != '1'" nzTitle="Groupings & Preferences" (nzClick)="view(13)"> </nz-tab>
          <nz-tab [nzDisabled]="userview.staffRecordView[3] != '1'"  nzTitle="Notes/Loans" (nzClick)="view(14)"></nz-tab>
        </nz-tabset>
      </div>
      
      <nz-empty *ngIf="user == null" style="margin-top:8rem" nzNotFoundImage="https://gw.alipayobjects.com/zos/antfincdn/ZHrcdLPrvN/empty.svg"
      [nzNotFoundContent]="contentTpl">
      <ng-template #contentTpl>
        <p>Select Staff</p>
      </ng-template>
    </nz-empty>
    
    <div nz-col nzSpan="24">
      <router-outlet></router-outlet>
    </div>
  </ng-container>
</div>

<ng-container *ngIf="userview?.staff < 951">
  <nz-result nzSubTitle="Sorry, you are not authorized to access the Staff function">
    <div nz-result-extra></div>
  </nz-result>
</ng-container>

</div>

<nz-modal [nzWidth]="800" [nzStyle]="{ top: '20px' }" [(nzVisible)]="terminateModal" nzTitle="Termination" (nzOnCancel)="terminateModal = false">
  <div nz-row [formGroup]="terminateGroup">
    <form nz-form [nzLayout]="'vertical'" [formGroup]="terminateGroup" >
      <nz-form-item>
        <nz-form-label [nzSpan]="24" nzFor="email">Date of Termination</nz-form-label>
        <nz-form-control [nzSpan]="16" nzErrorTip="Provide date of termination">
          <nz-date-picker formControlName="terminateDate"></nz-date-picker>
        </nz-form-control>
      </nz-form-item >
    </form>
    
    <div nz-row>
      <label for="">Current Leave Balances </label>
      <nz-table  nzSize="small" #basicTable [nzData]="leaveBalanceList">
        <thead>
          <tr>
            <th>Leave Type</th>
            <th>Leave Description</th>
            <th>Pro Rata Date</th>
            <th>Balance Hours</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let data of basicTable.data">
            <td>{{ data.leaveTypeCode }}</td>
            <td>{{ data.leaveDescription }}</td>
            <td>{{ data.proRataDate | date: 'M/d/yyyy'  }}</td>
            <td>{{ data.balanceHours }}</td>
          </tr>
        </tbody>
      </nz-table>
    </div>
    
    <div nz-row class="checks">
      <label nz-checkbox formControlName="deletePending">Delete any pending Leave Applications</label>
      <label nz-checkbox formControlName="unallocUnapproved">Unallocate any unapproved entries</label>
      <label nz-checkbox formControlName="unallocMaster">Unallocate Master Roster</label> 
    </div>
  </div>
  
  <div *nzModalFooter>
    <button nz-button nzType="default" (click)="terminateModal = false">Cancel</button>
    <button nz-button nzType="primary" (click)="terminate()"  [nzLoading]="isConfirmLoading">Terminate</button>
  </div>
</nz-modal>
<nz-modal [nzWidth]="400" [nzStyle]="{ top: '20px' }" [(nzVisible)]="changeCodeModal" nzTitle="Agency Defined Code" (nzOnCancel)="changeCodeModal = false">
  <div nz-row [formGroup]="updateStaff">
    <form nz-form [nzLayout]="'vertical'" [formGroup]="updateStaff" >
      <nz-form-item>
        <nz-form-label [nzSpan]="24" nzFor="Title">Code</nz-form-label>
        <nz-form-control [nzSpan]="24">
          <input type="text" formControlName="staffcode" nz-input>
        </nz-form-control>
      </nz-form-item >
    </form>
  </div>
  <div *nzModalFooter>
    <button nz-button nzType="default" (click)="changeCodeModal = false">Cancel</button>
    <button nz-button nzType="primary" (click)="updateStaffCode()"  [nzLoading]="isConfirmLoading">Update Staff Code</button>
  </div>
</nz-modal>
<nz-modal [nzWidth]="800" [nzStyle]="{ top: '20px' }" [(nzVisible)]="printSummaryModal" nzTitle="Print Staff Sheet Summary" (nzOnCancel)="printSummaryModal = false">
  <div nz-row [formGroup]="printSummaryGroup">
    <div nz-row class="checks" style="border: 1px solid;">
      <label nz-checkbox formControlName="fileLabels">File Labels (1 page - 30 Labels [Avery DL30) Stationary)</label>
    </div>
    <div nz-row class="checks">
      <div nz-row>
        <div nz-col nzSpan="10">
          <label nz-checkbox formControlName="nameandContacts">Name and Contact Details</label>
          <label nz-checkbox formControlName="contactIssue">Contact Issues</label>
          <label nz-checkbox formControlName="otherContact">Next of kin / Other Contacts</label> 
          <label nz-checkbox formControlName="otherInfo">Other Info</label> 
          <label nz-checkbox formControlName="payrollInfo">Payroll Info</label> 
          <label nz-checkbox formControlName="workhourInfo">Work Hours Info</label>
          <label nz-checkbox formControlName="copmpetencies">Competencies</label> 
          <label nz-checkbox formControlName="otherSkills">Other Skills</label>
          <label nz-checkbox formControlName="training">Training</label>
          <label nz-checkbox formControlName="roster">Roster</label>
          <label nz-checkbox formControlName="permanentRoster">Permanent Roster</label>
          <label nz-checkbox formControlName="miscellaneousNotes">Miscellaneous Notes</label>
          <label nz-checkbox formControlName="operationalNotes">Operational Notes</label>
          <label nz-checkbox formControlName="hrNotes">HR Notes</label>
          <label nz-checkbox formControlName="ItemsOnLoan">Items On Loan</label>
        </div>
        <div nz-col nzSpan="14">
          <label nz-checkbox formControlName="includeAdressress">Include All Addressess(Not Just primary,Usual,Contact)</label>
        </div>
      </div>
    </div>
    <div nz-row class="checks">
      <div nz-row nzJustify class="mrg-btm">
        <div nz-col nzSpan="6">
          <label nz-checkbox nzDisabled  formControlName="training">Training</label> 
        </div>
        <div *ngIf="this.printSummaryGroup.get('training').value">
        <div nz-col nzSpan="2">
          <label>From</label> 
        </div>
        <div nz-col nzSpan="4">
          <nz-date-picker formControlName="trainingFrom"></nz-date-picker>
        </div>
        <div nz-col nzSpan="2" class="text-center">
          <label>To</label>
        </div>
        <div nz-col nzSpan="4">
          <nz-date-picker formControlName="trainingTo"></nz-date-picker>
        </div>
        </div>
      </div>
      <div nz-row nzJustify class="mrg-btm">
        <div nz-col nzSpan="6">
          <label nz-checkbox nzDisabled  formControlName="operationalNotes">OP Notes</label> 
        </div>
        <div *ngIf="this.printSummaryGroup.get('operationalNotes').value">
        <div nz-col nzSpan="2">
          <label>From</label> 
        </div>
        <div nz-col nzSpan="4">
          <nz-date-picker formControlName="trainingFrom"></nz-date-picker>
        </div>
        <div nz-col nzSpan="2" class="text-center">
          <label>To</label>
        </div>
        <div nz-col nzSpan="4">
          <nz-date-picker formControlName="trainingTo"></nz-date-picker>
        </div>
        </div>
      </div>
      <div nz-row nzJustify class="mrg-btm">
        <div nz-col nzSpan="6">
          <label nz-checkbox nzDisabled  formControlName="hrNotes">HR Notes</label> 
        </div>
        <div *ngIf="this.printSummaryGroup.get('hrNotes').value">
          <div nz-col nzSpan="2">
            <label>From</label> 
          </div>
          <div nz-col nzSpan="4">
            <nz-date-picker formControlName="trainingFrom"></nz-date-picker>
          </div>
          <div nz-col nzSpan="2" class="text-center">
            <label>To</label>
          </div>
          <div nz-col nzSpan="4">
            <nz-date-picker formControlName="trainingTo"></nz-date-picker>
          </div>
        </div>
      </div>
      <div nz-row nzJustify class="mrg-btm">
        <div nz-col nzSpan="6">
          <label nz-checkbox nzDisabled  formControlName="roster">Roster</label> 
        </div>
        <div *ngIf="this.printSummaryGroup.get('roster').value">
          <div nz-col nzSpan="2">
            <label>From</label> 
          </div>
          <div nz-col nzSpan="4">
            <nz-date-picker formControlName="trainingFrom"></nz-date-picker>
          </div>
          <div nz-col nzSpan="2" class="text-center">
            <label>To</label>
          </div>
          <div nz-col nzSpan="4">
            <nz-date-picker formControlName="trainingTo"></nz-date-picker>
          </div>
          <div nz-col nzSpan="6">
            <nz-select [nzDropdownMatchSelectWidth]="false" formControlName="recepientSearc" nzShowSearch nzAllowClear style="width:100%;">
              <nz-option nzValue="Show RECIPIENT CODE" nzLabel="Show RECIPIENT CODE"></nz-option>
              <nz-option nzValue="Show RECIPIENT First Name" nzLabel="Show RECIPIENT First Name"></nz-option> 
              <nz-option nzValue="Show RECIPIENT File#" nzLabel="Show RECIPIENT File#"></nz-option>
              </nz-select>
          </div>
        </div>
      </div>
      <div nz-row nzJustify class="mrg-btm">
        <div nz-col nzSpan="6">
          <label nz-checkbox nzDisabled formControlName="permanentRoster">Permanent Roster</label> 
        </div>
        <div *ngIf="this.printSummaryGroup.get('permanentRoster').value">
          <!-- <div nz-col nzSpan="2">
            <label>From</label> 
          </div>
          <div nz-col nzSpan="4">
            <nz-date-picker formControlName="trainingFrom"></nz-date-picker>
          </div>
          <div nz-col nzSpan="2" class="text-center">
            <label>To</label>
          </div>
          <div nz-col nzSpan="4">
            <nz-date-picker formControlName="trainingTo"></nz-date-picker>
          </div> -->
        </div>
      </div>
    </div>  
  </div>
  <div *nzModalFooter>
    <button nz-button nzType="default" (click)="terminateModal = false">Cancel</button>
    <button nz-button nzType="primary" (click)="terminate()"  [nzLoading]="isConfirmLoading">Terminate</button>
  </div>
</nz-modal>
<nz-modal [nzWidth]="800" [nzStyle]="{ top: '20px' }" [(nzVisible)]="terminateModal" nzTitle="Termination" (nzOnCancel)="terminateModal = false">
  <div nz-row [formGroup]="terminateGroup">
    <form nz-form [nzLayout]="'vertical'" [formGroup]="terminateGroup" >
      <nz-form-item>
        <nz-form-label [nzSpan]="24" nzFor="email">Date of Termination</nz-form-label>
        <nz-form-control [nzSpan]="16" nzErrorTip="Provide date of termination">
          <nz-date-picker formControlName="terminateDate"></nz-date-picker>
        </nz-form-control>
      </nz-form-item >
    </form>
    
    <div nz-row>
      <label for="">Current Leave Balances </label>
      <nz-table  nzSize="small" #basicTable [nzData]="leaveBalanceList">
        <thead>
          <tr>
            <th>Leave Type</th>
            <th>Leave Description</th>
            <th>Pro Rata Date</th>
            <th>Balance Hours</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let data of basicTable.data">
            <td>{{ data.leaveTypeCode }}</td>
            <td>{{ data.leaveDescription }}</td>
            <td>{{ data.proRataDate | date: 'M/d/yyyy'  }}</td>
            <td>{{ data.balanceHours }}</td>
          </tr>
        </tbody>
      </nz-table>
    </div>
    
    <div nz-row class="checks">
      <label nz-checkbox formControlName="deletePending">Delete any pending Leave Applications</label>
      <label nz-checkbox formControlName="unallocUnapproved">Unallocate any unapproved entries</label>
      <label nz-checkbox formControlName="unallocMaster">Unallocate Master Roster</label> 
    </div>
  </div>
  
  <div *nzModalFooter>
    <button nz-button nzType="default" (click)="terminateModal = false">Cancel</button>
    <button nz-button nzType="primary" (click)="terminate()"  [nzLoading]="isConfirmLoading">Terminate</button>
  </div>
</nz-modal>
<app-leave-application *ngIf="user" [open]="putonLeaveModal" [user]="user"></app-leave-application>
<app-add-staff [open]="newStaffModal" (reload)="reload($event)"></app-add-staff>